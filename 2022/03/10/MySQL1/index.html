<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MySQL基础 | Year 21's Blog</title><meta name="keywords" content="MySQL"><meta name="author" content="Year 21"><meta name="copyright" content="Year 21"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="初识数据库持久化：将数据保存到可掉电式存储设备中。 作用：将内存中的数据存储在关系型数据库中，也可是磁盘文件或XML数据文件 DB：数据库(Database) 存储数据的“仓库”，相当于为存储数据的文件夹 DBMS：数据库管理系统(Database Management System) 管理和操作数据库的大型软件，可理解为一个软件 SQL：结构化查询语言(Structured Query Lang">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础">
<meta property="og:url" content="http://xxxccc1986.github.io/2022/03/10/MySQL1/index.html">
<meta property="og:site_name" content="Year 21&#39;s Blog">
<meta property="og:description" content="初识数据库持久化：将数据保存到可掉电式存储设备中。 作用：将内存中的数据存储在关系型数据库中，也可是磁盘文件或XML数据文件 DB：数据库(Database) 存储数据的“仓库”，相当于为存储数据的文件夹 DBMS：数据库管理系统(Database Management System) 管理和操作数据库的大型软件，可理解为一个软件 SQL：结构化查询语言(Structured Query Lang">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://w.wallhaven.cc/full/x8/wallhaven-x82d1d.png">
<meta property="article:published_time" content="2022-03-10T08:24:02.000Z">
<meta property="article:modified_time" content="2022-03-10T08:24:02.000Z">
<meta property="article:author" content="Year 21">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://w.wallhaven.cc/full/x8/wallhaven-x82d1d.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://xxxccc1986.github.io/2022/03/10/MySQL1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Year 21","link":"链接: ","source":"来源: Year 21's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://jsdelivr.pai233.top/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://jsdelivr.pai233.top/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL基础',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2022-03-10 16:24:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s4.ax1x.com/2022/01/18/7BWTQx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://w.wallhaven.cc/full/x8/wallhaven-x82d1d.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Year 21's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-10T08:24:02.000Z" title="发表于 2022-03-10 16:24:02">2022-03-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-10T08:24:02.000Z" title="更新于 2022-03-10 16:24:02">2022-03-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/DataBase/">DataBase</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">24.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>88分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySQL基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="初识数据库"><a href="#初识数据库" class="headerlink" title="初识数据库"></a>初识数据库</h2><p>持久化：将数据保存到可掉电式存储设备中。</p>
<p>作用：将内存中的数据存储在关系型数据库中，也可是磁盘文件或XML数据文件</p>
<p><strong>DB：数据库(Database)</strong></p>
<p>存储数据的“仓库”，相当于为存储数据的文件夹</p>
<p><strong>DBMS：数据库管理系统(Database Management System)</strong></p>
<p>管理和操作数据库的大型软件，可理解为一个软件</p>
<p><strong>SQL：结构化查询语言(Structured Query Language)</strong></p>
<p>用于于数据库通信的语言，理解为对数据库数据的一种增删改查的手段</p>
<h3 id="常见数据库"><a href="#常见数据库" class="headerlink" title="常见数据库"></a>常见数据库</h3><ol>
<li><p>Oracle甲骨文</p>
<p>Oracle 2 —-RDBMS(关系型数据库管理系统)</p>
<p>Oracle  —&gt; BEA Systems —&gt; SUN公司 —&gt; MySQL</p>
</li>
<li><p>MySQL</p>
<p>①开放源代码的关系型数据库管理系统</p>
<p>②32位系统表文件最大支持4GB，64位系统支持最大的表文件8TB</p>
</li>
<li><p>SQL Server</p>
<p>微软开发的大型商业数据库</p>
</li>
<li><p>DB2</p>
</li>
</ol>
<p>​		IBM公司，用于银行系统</p>
<ol start="4">
<li><p>PostgreSQL</p>
<p>简称PgSQL，是开源的</p>
</li>
<li><p>SyBase</p>
<p>提供了数据建模 PowerDesigner</p>
</li>
<li><p>SQLite</p>
<p>嵌入式小型数据库，应用在手机端</p>
</li>
<li><p>informix</p>
<p>IBM公司，运用于unix和linux平台</p>
</li>
</ol>
<h3 id="关系型数据库-RDBMS"><a href="#关系型数据库-RDBMS" class="headerlink" title="关系型数据库(RDBMS)"></a>关系型数据库(RDBMS)</h3><ol>
<li><p>最古老的数据库类型，将数据结构变为了简单的二维关系</p>
</li>
<li><p><strong>以“行(row)“ 和 “列(column)” 的形式存储数据 —-&gt; 一行一列构成了表(table) —-&gt; 一组表形成一个库 (datebase)</strong></p>
</li>
<li><p>表与表之间数据记录有关系，<strong>关系型数据库即建立在关系模型基础上的数据库</strong></p>
</li>
<li><p>优势</p>
<p>①可进行复杂查询：用SQL语句在多个表之间进行复杂的数据查询</p>
<p>②事务支持：实现对安全性能较高的数据访问</p>
</li>
</ol>
<h3 id="非关系型数据库-非RDBMS"><a href="#非关系型数据库-非RDBMS" class="headerlink" title="非关系型数据库(非RDBMS)"></a>非关系型数据库(非RDBMS)</h3><ol>
<li><p>可以理解为阉割版的RDBMS，舍弃部分功能以提高查询性能</p>
</li>
<li><p>非RDBMS的数据库类型</p>
<p>①键值型数据库：经常用于内存缓存。主流的是Redis键值型数据库</p>
<p>②文档型数据库：用于存储并获取数据，例如XML、JSON等格式</p>
<p>③搜索引擎数据库：<strong>核心原理是”倒排索引“，对全文索引效率较低</strong>。主流：Solr、Elasticsearch、Splunk等</p>
<p>④列式数据库：大量降低系统的I&#x2F;O，适合分布式文件系统。主流：HBase。</p>
<p>⑤图形数据库：经常用于刻画对象之间的关系。主流：Neo4J、InfoGrid</p>
</li>
</ol>
<h3 id="关系型数据库的设计规则"><a href="#关系型数据库的设计规则" class="headerlink" title="关系型数据库的设计规则"></a>关系型数据库的设计规则</h3><p>数据库的典型结构是数据表，一个数据库可以有多张表，每张表都有一个名字，<strong>而表名具有唯一性</strong></p>
<ol>
<li>E-R(entity-relationship，实体-练习)的模型主要概念：实体集、属性、联系集</li>
</ol>
<p>​		ORM(Object Relation Mapping)对象关系映射：</p>
<p>​		表table &lt;—&gt; (实体集)类class		行(row)  &lt;—&gt;  (实体)类的对象Instance	列(column)  &lt;—&gt;  (字段)类中的属性field</p>
<ol start="2">
<li><p>表的关联关系</p>
<p>4种关系：一对一关联‘、一对多关联、多对多关联、自我引用</p>
</li>
</ol>
<hr>
<h2 id="SQL语言"><a href="#SQL语言" class="headerlink" title="SQL语言"></a>SQL语言</h2><h3 id="SQL语言的分类"><a href="#SQL语言的分类" class="headerlink" title="SQL语言的分类"></a>SQL语言的分类</h3><ol>
<li><p>DDL（Data Definition Languages）数据定义语言</p>
<p>CREATE(创建)  \ ALTER(修改)  \  DROP(删除)  \ RENAME(重命名)  \TRUNCATE(清空)</p>
</li>
<li><p>DML（Data Manipulation Language）数据操作语言</p>
<p>INSERT (添加)  \ DELETE(删除) \ UPDATE(更改) \ SELECT(查询)</p>
</li>
<li><p>DCL（Data Control Language）数据控制语言</p>
<p>GRANT(赋予权限)  \  REVOKE(回收权限)  \  COMMIT(提交)  \ ROLLBACK(回滚)  \  SAVEPOINT(保存点)</p>
</li>
</ol>
<ul>
<li>SELECT查询语句使用频率较高，因此其又被独称一类：DQL（Date Query Language数据查询语言）</li>
<li>还有将 COMMIT 、 ROLLBACK 两者共称为TCL （Transaction Control Language，事务控制语言）</li>
</ul>
<h3 id="SQL语言的规则与规范"><a href="#SQL语言的规则与规范" class="headerlink" title="SQL语言的规则与规范"></a>SQL语言的规则与规范</h3><ol>
<li>每条命令以 ; 或 \g 或 \G 结束</li>
<li>关键字都是大写的，不能缩写，也不能分行</li>
</ol>
<h4 id="SQL大小写不同环境区别"><a href="#SQL大小写不同环境区别" class="headerlink" title="SQL大小写不同环境区别"></a>SQL大小写不同环境区别</h4><ol>
<li><p>MySQL 在 Windows 环境下是大小写不敏感的</p>
</li>
<li><p>MySQL 在 Linux 环境下是大小写敏感的</p>
<ul>
<li>数据库名、表名、表的别名、变量名是严格区分大小写的 </li>
<li>关键字、函数名、列名(或字段名)、列的别名(字段的别名) 是忽略大小写的。</li>
</ul>
</li>
<li><p>推荐采用统一的书写规范： </p>
<ul>
<li>数据库名、表名、表别名、字段名、字段别名等都小写 </li>
<li>SQL 关键字、函数名、绑定变量等都大写</li>
</ul>
<p><strong>补充：在SQL中字符串用单引号，列的别名用双引号</strong></p>
</li>
<li><p>注释</p>
<ul>
<li>单行注释：#注释文字(MySQL特有的方式)</li>
<li>单行注释：– 注释文字(–后面必须包含一个空格。) </li>
<li>多行注释：&#x2F;* 注释文字 *&#x2F;</li>
</ul>
</li>
</ol>
<ul>
<li>补充 导入数据库的方式：①source 文件的全路径  ②利用图形化界面的工具</li>
</ul>
<hr>
<h2 id="基本的SELECT语句"><a href="#基本的SELECT语句" class="headerlink" title="基本的SELECT语句"></a>基本的SELECT语句</h2><ol>
<li>SELECT</li>
</ol>
<ul>
<li><p>SELECT 字段1，字段2 FROM 表名</p>
</li>
<li><p>SELECT * FROM 表名；&#x2F;&#x2F;* 表中的所有字段(或列)</p>
</li>
<li><p>查询字段返回的结果称为结果集</p>
</li>
</ul>
<ol start="2">
<li><p>列的别名</p>
<p>创建类的别名的方式</p>
<p>①列名后空格 起名</p>
<p>②as(别名) ：alias</p>
<p>③使用一对“ ”包起来；</p>
</li>
</ol>
<p><strong>补充：列的别名只能在关键字ORDER BY中使用，不能在WHERE中使用</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee_id emp_id,last_name <span class="keyword">AS</span> lname,department_id &quot;部门id&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>去重关键字：distinct</p>
</li>
<li><p>空值参与运算</p>
<p>①空值：null，其参与运算的结果都为空（null）</p>
<p>②null 不等同于0或者‘null’，仅仅只是说明不确定有没有 比如奖金为0是没有  奖金为null是不确定有没有</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#空值参与运算</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary &quot;月工资&quot;,salary <span class="operator">*</span> (<span class="number">1</span> <span class="operator">+</span> IFNULL(commission_pct,<span class="number">0</span>)) <span class="operator">*</span> <span class="number">12</span> &quot;年工资&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>着重号 &#96;&#96;</p>
<p>作用：当数据库名或表名与关键字、保留字相同时，使用着重号&#96;&#96;表示输入的是表名或数据库名</p>
</li>
<li><p>查询常数</p>
<p>数据的每一行都会添加此常数（不一定在此表中存在）</p>
<p>下面的‘北京市’即为常数</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#查询常数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;北京市&#x27;</span>,employee_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ol start="7">
<li><p>显示表结构</p>
<p>关键字：describe</p>
<p>DESCRIBE 表名;</p>
</li>
<li><p>过滤数据</p>
<p>关键字：where ，需要声明在from的后面</p>
<p>使用注意：字符串需要使用一对’ ‘修饰，与Java的字符串有所区别</p>
</li>
</ol>
<hr>
<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><p>&#x2F;(DIV) 都表示除法运算：div 和 &#x2F;的区别：</p>
<p>整数  DIV  整数  &#x3D; 整数 例如 100 DIV 3 &#x3D; 33；</p>
<p>整数 &#x2F; 整数 &#x3D; 取商的整数部分+默认保留小数点后四位  例如： 100 &#x2F; 3 &#x3D; 33.3333</p>
<p>%(MOD)：</p>
<p>在SQL中，+ 号没有连接的作用，仅仅表示加法运算</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#在java中为<span class="number">1001</span>，这里的‘<span class="number">1</span>’ 和 java中的“<span class="number">1</span>”是一样的 因为<span class="keyword">sql</span>中字符串是以 ‘  ’  修饰的</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;# DUAL 伪表</span><br><span class="line">#在<span class="keyword">SQL</span>中结果为<span class="number">101</span>，此时，字符串转换为了数值（隐式转换）</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="string">&#x27;a&#x27;</span> # 结果为<span class="number">100</span>，此时<span class="string">&#x27;a&#x27;</span> 看作<span class="number">0</span>处理</span><br><span class="line"><span class="keyword">FROM</span> DUAL;# DUAL 伪表</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">+</span> <span class="keyword">NULL</span> # 结果为<span class="keyword">null</span>，<span class="keyword">null</span>参与运算结果都是<span class="keyword">null</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;# DUAL 伪表</span><br></pre></td></tr></table></figure>

<h3 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h3><p>符号：&#x3D;(等于)、&lt;&#x3D;&gt;(安全等于)、&lt;&gt;或!&#x3D;(均是不等于)、</p>
<p>判断都是true，则返回1；判断都是false，则返回0，其余情况返回null</p>
<p><strong>特殊的：&lt;&#x3D;&gt;安全等于是为区别 null的情况，两个数值都为null返回1；其中一个为null返回0</strong></p>
<p>​	规则；</p>
<ol>
<li>字符串存在隐式转换，如果转换数值不成功，则默认当成0</li>
<li>两边都是字符串的花，则按照ANSI的比较规则进行比较</li>
<li>只要有null 参与判断，结果就为null；</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#对应第一种</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span>,<span class="number">1</span><span class="operator">!=</span> <span class="number">2</span>,<span class="number">1</span> <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span>,<span class="number">1</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>,<span class="number">0</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line">#对应第二种</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;a&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;ab&#x27;</span><span class="operator">=</span> <span class="string">&#x27;ab&#x27;</span>,<span class="string">&#x27;a&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;b&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br><span class="line">#对应第三种</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="operator">=</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span> <span class="operator">=</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h3 id="相关关键字"><a href="#相关关键字" class="headerlink" title="相关关键字"></a>相关关键字</h3><ol>
<li><p>is null(为空) 	\ is not null(不为空)	 \ isnull类似一个方法&#x3D;&#x3D; WHERE ISNULL(commission_pct);</p>
</li>
<li><p>least(value1,value2) ：取两者中小的输出	\ greatest(value1,value2)：取两者中大的输出</p>
</li>
<li><p>between 条件下限1 and 条件上限2 (查询条件1和条件2范围内的数据，包括条件1、2其本身的数据)</p>
</li>
<li><p>in(set)：查询是set集合数值的数据信息     \not in(set)：查询不是set集合数值的数据信息</p>
</li>
<li><p>like()：模糊查询      % ：代表不确定个数的字符(0个,1个,多个)      _ ：代表一个不确定的字符   转义字符：\</p>
</li>
<li><p>正则表达式运算符：regexp \ rlike ：</p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="left">正则表达式</th>
</tr>
</thead>
<tbody><tr>
<td align="left">（1）‘^’匹配以该字符后面的字符开头的字符串。</td>
</tr>
<tr>
<td align="left">（2）‘$’匹配以该字符前面的字符结尾的字符串。</td>
</tr>
<tr>
<td align="left">（3）‘.’匹配任何一个单字符。</td>
</tr>
<tr>
<td align="left">（4）“[…]”匹配在方括号内的任何字符。例如，“[abc]”匹配“a”或“b”或“c”。为了命名字符的范围，使用一 个‘-’。“[a-z]”匹配任何字母，而“[0-9]”匹配任何数字。</td>
</tr>
<tr>
<td align="left">（5）‘<em>’匹配零个或多个在它前面的字符。例如，“x</em>”匹配任何数量的‘x’字符，“[0-9]<em>”匹配任何数量的数字， 而“</em>”匹配任何数量的任何字符。</td>
</tr>
</tbody></table>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><p>符号：XOR(逻辑异或)：取满足一真一假的结果、OR(||)、AND(&amp;&amp;)、!(NOT) </p>
<p><strong>补充：OR可以和AND一起使用，但由于AND的优先级高于OR，因此先 对AND两边的操作数进行操作，再与OR中的操作数结合。</strong></p>
<h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><p>取反从底层二进制是从最高位逐个取反</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhOARx.png" alt="位运算符"></p>
<hr>
<h2 id="排序与分页"><a href="#排序与分页" class="headerlink" title="排序与分页"></a>排序与分页</h2><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p><strong>如果没有使用任何排序操作，默认情况下查询返回的数据是按照添加数据的顺序显示的</strong></p>
<ol>
<li><p>使用关键字ORDER BY 进行排序操作</p>
<p>升序：asc(ascend)；从低到高</p>
<p>降序：desc(descend)；从高到低</p>
<p>一般在 ORDER BY 字段 后面没有显示的声明使用哪种排序方式，则默认使用的是升序排列</p>
<p><strong>补充：列的别名只能在关键字中使用，不能在WHERE中使用</strong></p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#降序：<span class="keyword">desc</span>(descend)；从高到低</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">#升序：<span class="keyword">asc</span>(ascend)；从低到高</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<h3 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h3><ol>
<li><p>使用关键字LIMIT实现数据的分页操作</p>
</li>
<li><p>格式： LIMIT：LIMIT位置偏移量，条目数 </p>
<p>在一定情况下，”LIMIT  0,条目数“ &#x3D;&#x3D; ”LIMIT 条目数“ </p>
</li>
<li><p><strong>运用公式：LIMIT(pageNO - 1) * pageSize，pageSize；</strong></p>
</li>
<li><p>WHERE  …  ORDER BY … LIMIT 声明顺序如下</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department_id,salary,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">&gt;</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_id <span class="keyword">DESC</span>,salary <span class="keyword">ASC</span>;</span><br><span class="line">LIMIT <span class="number">0</span>,<span class="number">10</span>;#LIMIT声明在最后面</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>MySQL8.0新特性：LIMIT … OFFSET … ；</li>
</ol>
<p>​	在8.0与5.7有明显的区别	LIMIT 条目数  OFFSET	LIMIT位置偏移量.；</p>
<hr>
<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p><strong>多张表写成一张表会造成冗余、多IO、事务方面锁定的影响</strong></p>
<h3 id="笛卡尔积-交叉连接-现象"><a href="#笛卡尔积-交叉连接-现象" class="headerlink" title="笛卡尔积(交叉连接)现象"></a>笛卡尔积(交叉连接)现象</h3><p><strong>多表查询中笛卡尔积的错误现象：是指一张表中的数据在另一个表中全都匹配了一次——原因是：缺少了连接条件</strong></p>
<p>正确的查询操作：注（在查询语句中如果存在多个表有相同的字段，则必须指明此字段所在的表</p>
<p>为了增加sql语句的可读性，可以考虑给表起别名，但是在之后的在select和where中必须使用别名，不能使用表的原名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#SQL92的写法</span><br><span class="line"><span class="keyword">SELECT</span> employees.employee_id,departments.department_name,employees.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees,departments</span><br><span class="line"><span class="keyword">WHERE</span> employees.employee_id <span class="operator">=</span> departments.department_id;</span><br><span class="line"></span><br><span class="line">#使用别名的多表查询</span><br><span class="line"><span class="keyword">SELECT</span> emp.employee_id,dep.department_name,emp.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees emp,departments dep</span><br><span class="line"><span class="keyword">WHERE</span> emp.employee_id <span class="operator">=</span> dep.department_id;</span><br></pre></td></tr></table></figure>

<p>结论：如果有n个表进行多表的的查询，则至少需要n-1个连接条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> emp.`employee_id`,emp.`last_name`,dep.`department_name`,loc.`city`</span><br><span class="line"><span class="keyword">FROM</span> employees emp,departments dep,locations loc</span><br><span class="line"><span class="keyword">WHERE</span> emp.`department_id` <span class="operator">=</span> dep.`department_id` </span><br><span class="line"><span class="keyword">AND</span> dep.`location_id` <span class="operator">=</span> loc.`location_id`;</span><br></pre></td></tr></table></figure>

<h3 id="多表查询的分类"><a href="#多表查询的分类" class="headerlink" title="多表查询的分类"></a>多表查询的分类</h3><h4 id="等值连接-与-非等值连接"><a href="#等值连接-与-非等值连接" class="headerlink" title="等值连接  与  非等值连接"></a>等值连接  与  非等值连接</h4><p>等值连接：连接条件使用等于&#x3D; 的连接</p>
<p>非等值连接：连接条件不使用等于&#x3D; 的连接，包括!&#x3D;!、&gt;、&lt;等</p>
<h4 id="自连接-与-非自连接"><a href="#自连接-与-非自连接" class="headerlink" title="自连接   与   非自连接"></a>自连接   与   非自连接</h4><p>自连接 ：同一张表的查询连接</p>
<p>非自连接：不是同一张表的查询连接</p>
<h4 id="内连接-与-外连接"><a href="#内连接-与-外连接" class="headerlink" title="内连接   与   外连接"></a>内连接   与   外连接</h4><ol>
<li>内连接：查询返回的结果集只包含符合条件的行，结果集中不包含一个表与另一个表不匹配的行</li>
</ol>
<p>​		举个例子：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#SQL92语法实现的内连接</span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id,d.department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line">#此时的结果为<span class="number">106</span>行，但是employees的表中有<span class="number">107</span>行</span><br><span class="line">#原因是有一行员工是没有部门的，因此不匹配导致没输出</span><br><span class="line"></span><br><span class="line">#SQL92语法实现外连接</span><br><span class="line">#<span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id(<span class="operator">+</span>);</span><br></pre></td></tr></table></figure>

<p>​	2. 外连接：查询返回的结果集只包含符合条件的行，结果集中除了包含一个表与另一个表匹配的行以外，还包括左表 和 右表中不匹配的行</p>
<p>​		外连接的分类：左外连接(符合匹配结果集以及左表不满足的行)</p>
<p>​								   右外连接(符合匹配结果集以及右表不满足的行)</p>
<p>​								   满外连接(符合匹配结果集以及左表、右表不满足的行)</p>
<ol start="3">
<li><p>SQL92语法实现内连接：见上方例子代码</p>
<p>SQL92语法实现外连接：使用 + 号 ————但在MySQL中不支持此写法</p>
</li>
<li><p>SQL99语法实现多表查询：JOIN …  ON的方式——MySQL支持此写法</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#sql99语法实现内连接</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,city</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d#此处的<span class="keyword">INNER</span>可省略</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.department_id </span><br><span class="line"><span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.`location_id` <span class="operator">=</span> l.`location_id`;</span><br><span class="line"></span><br><span class="line">#sql99语法实现外连接</span><br><span class="line">#左外连接</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d#此处的<span class="keyword">OUTER</span>可省略</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#右外连接</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d#此处的<span class="keyword">OUTER</span>可省略</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#满外连接<span class="comment">----MySQL不支持FULL</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d#此处的<span class="keyword">OUTER</span>可省略</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7种JOIN的方式"><a href="#7种JOIN的方式" class="headerlink" title="7种JOIN的方式"></a>7种JOIN的方式</h4><p><strong>注针对左外或者右外只取其中左表活右表的数据</strong>：</p>
<p>此时左外连接相当于左边数据比右边数据长，因此右边需要补一个null值，而左中图是只要左表不匹配的数据</p>
<p>也就是说此时类似交集部分的右表的值不是空的，因此过滤条件是只要右表为null的</p>
<p>右中图反着来，同个道理，在此不做说明</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#sql99语法</span><br><span class="line">#左上图 左外连接</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d#此处的<span class="keyword">OUTER</span>可省略</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#右上图 右外连接</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d#此处的<span class="keyword">OUTER</span>可省略</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#中间图  内连接</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`;</span><br><span class="line"></span><br><span class="line">#左中图</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_id`<span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#右中图</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#左下图 满外连接</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#右下图</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_id`<span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>



<p><img src="https://s1.ax1x.com/2022/03/10/bhOmLD.png" alt="多种连接图示意"></p>
<h3 id="UNION关键字"><a href="#UNION关键字" class="headerlink" title="UNION关键字"></a>UNION关键字</h3><ol>
<li>UNION：返回两个查询结果集的并集，去除重复部分</li>
<li>UNION ALL ：返回两个查询结果集的并集，对于重复部分，不去除</li>
</ol>
<p>一般来说，尽量选择使用UNION ALL，相对于UNION来说UNION ALL 效率更高，因为不涉及去重</p>
<p>举个例子：1 ; 106 ; 16   </p>
<p>​		UNION返回的结果是1+106+16，UNION ALL返回的结果是1+106+106+16</p>
<h3 id="SQL99语法新特性-了解"><a href="#SQL99语法新特性-了解" class="headerlink" title="SQL99语法新特性(了解)"></a>SQL99语法新特性(了解)</h3><ol>
<li><p>自然连接：NATURAL  JOIN</p>
<p>可以理解为SQL92语法种等值连接，一般会自动查询两张连接表的所有相同字段并给予返回字符集，但是不够灵活</p>
</li>
<li><p>USING的使用</p>
<p>不适用于自连接</p>
</li>
</ol>
<p>​		可以理解为NATURAL  JOIN的改良版，可以查询返回指定的相同字段的字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#自然连接</span><br><span class="line"><span class="keyword">SELECT</span> e.`employee_id`,e.`last_name`,d.`department_name`</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> departments d;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">USING</span>连接</span><br><span class="line"><span class="keyword">SELECT</span> e.`employee_id`,e.`last_name`,d.`department_name`</span><br><span class="line"><span class="keyword">FROM</span> employees e  <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">USING</span> (department_id);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>不同的DBMS之间关于函数的定义的差异远大于同个语言种的不同版本</p>
<p> 内置函数 	 自定义函数</p>
<h3 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h3><p>概念：只对一行进行变换，每行只返回一个结果，且可以进行嵌套，参数可以为某一列或者一个字符串</p>
<h4 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h4><ol>
<li>基本函数-</li>
</ol>
<table>
<thead>
<tr>
<th align="left">ABS(x) 返回x的绝对值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SIGN(X)返回X的符号。正数返回1，负数返回-1，0返回0</td>
</tr>
<tr>
<td align="left">PI() 返回圆周率的值</td>
</tr>
<tr>
<td align="left">CEIL(x)，CEILING(x) 返回大于或等于某个值的最小整数</td>
</tr>
<tr>
<td align="left">FLOOR(x) 返回小于或等于某个值的最大整数</td>
</tr>
<tr>
<td align="left">LEAST(e1,e2,e3…) 返回列表中的最小值</td>
</tr>
<tr>
<td align="left">GREATEST(e1,e2,e3…) 返回列表中的最大值</td>
</tr>
<tr>
<td align="left">MOD(x,y) 返回X除以Y后的余数</td>
</tr>
<tr>
<td align="left">RAND() 返回0~1的随机值</td>
</tr>
<tr>
<td align="left">RAND(x) 返回0~1的随机值，其中x的值用作种子值，相同的X值会产生相同的随机 数</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">ROUND(x) 返回一个对x的值进行四舍五入后，最接近于X的整数</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ROUND(x,y) 返回一个对x的值进行四舍五入后最接近X的值，并保留到小数点后面Y位</td>
</tr>
<tr>
<td align="left">TRUNCATE(x,y) 返回数字x截断为y位小数的结果</td>
</tr>
<tr>
<td align="left">SQRT(x) 返回x的平方根。当X的值为负数时，返回NULL</td>
</tr>
</tbody></table>
<ol start="2">
<li>角度 与 弧度 转换</li>
</ol>
<p>​			RADIANS(x) 将角度转化为弧度，其中，参数x为角度值 </p>
<p>​			DEGREES(x) 将弧度转化为角度，其中，参数x为弧度值</p>
<ol start="3">
<li>三角函数</li>
</ol>
<table>
<thead>
<tr>
<th align="left">SIN(x) 返回x的正弦值，其中，参数x为弧度值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ASIN(x) 返回x的反正弦值，即获取正弦为x的值。如果x的值不在-1到1之间，则返回NULL</td>
</tr>
<tr>
<td align="left">COS(x) 返回x的余弦值，其中，参数x为弧度值</td>
</tr>
<tr>
<td align="left">ACOS(x) 返回x的反余弦值，即获取余弦为x的值。如果x的值不在-1到1之间，则返回NULL</td>
</tr>
<tr>
<td align="left">TAN(x) 返回x的正切值，其中，参数x为弧度值</td>
</tr>
<tr>
<td align="left">ATAN(x) 返回x的反正切值，即返回正切值为x的值</td>
</tr>
<tr>
<td align="left">ATAN2(m,n) 返回两个参数的反正切值</td>
</tr>
<tr>
<td align="left">COT(x) 返回x的余切值，其中，X为弧度值</td>
</tr>
</tbody></table>
<ol start="4">
<li>指数与对数</li>
</ol>
<table>
<thead>
<tr>
<th align="left">POW(x,y)，POWER(X,Y) 返回x的y次方</th>
</tr>
</thead>
<tbody><tr>
<td align="left">EXP(X) 返回e的X次方，其中e是一个常数，2.718281828459045</td>
</tr>
<tr>
<td align="left">LOG(X) 返回以e为底的X的对数，当X &lt;&#x3D; 0 时，返回的结果为NULL</td>
</tr>
<tr>
<td align="left">LN(X)，LOG10(X) 返回以10为底的X的对数，当X &lt;&#x3D; 0 时，返回的结果为NULL</td>
</tr>
<tr>
<td align="left">LOG2(X) 返回以2为底的X的对数，当X &lt;&#x3D; 0 时，返回NULL</td>
</tr>
</tbody></table>
<ol start="5">
<li>进制转换</li>
</ol>
<table>
<thead>
<tr>
<th align="left">BIN(x) 返回x的二进制编码</th>
</tr>
</thead>
<tbody><tr>
<td align="left">HEX(x) 返回x的十六进制编码</td>
</tr>
<tr>
<td align="left">OCT(x) 返回x的八进制编码</td>
</tr>
<tr>
<td align="left">CONV(x,f1,f2) 返回f1进制数变成f2进制数</td>
</tr>
</tbody></table>
<h4 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数-"></a>字符串函数-</h4><p><strong>注意：MySQL中，字符串的位置是从1开始的。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ASCII(S) 返回字符串S中的第一个字符的ASCII码值</span></span><br><span class="line"><span class="comment">CHAR_LENGTH(s) 	返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同</span></span><br><span class="line"><span class="comment">LENGTH(s) 	返回字符串s的字节数，和字符集有关</span></span><br><span class="line"><span class="comment">CONCAT(s1,s2,......,sn) 	连接s1,s2,......,sn为一个字符串</span></span><br><span class="line"><span class="comment">CONCAT_WS(x,s1,s2,......,sn)	同CONCAT(s1,s2,...)函数，但是每个字符串之间要加上x</span></span><br><span class="line"><span class="comment">INSERT(str, idx, len,replacestr)	将字符串str从第idx位置开始，len个字符长的子串替换为字符串replacestr</span></span><br><span class="line"><span class="comment">REPLACE(str, a, b) 用字符串b替换字符串str中所有出现的字符串a</span></span><br><span class="line"><span class="comment">UPPER(s) 或 UCASE(s) 将字符串s的所有字母转成大写字母</span></span><br><span class="line"><span class="comment">LOWER(s) 或LCASE(s) 将字符串s的所有字母转成小写字母</span></span><br><span class="line"><span class="comment">LEFT(str,n) 返回字符串str最左边的n个字符</span></span><br><span class="line"><span class="comment">RIGHT(str,n) 返回字符串str最右边的n个字符</span></span><br><span class="line"><span class="comment">LPAD(str, len, pad) 用字符串pad对str最左边进行填充，直到str的长度为len个字符</span></span><br><span class="line"><span class="comment">RPAD(str ,len, pad) 用字符串pad对str最右边进行填充，直到str的长度为len个字符</span></span><br><span class="line"><span class="comment">LTRIM(s) 去掉字符串s左侧的空格</span></span><br><span class="line"><span class="comment">RTRIM(s) 去掉字符串s右侧的空格</span></span><br><span class="line"><span class="comment">TRIM(s) 去掉字符串s开始与结尾的空格</span></span><br><span class="line"><span class="comment">TRIM(s1 FROM s) 去掉字符串s开始与结尾的s1</span></span><br><span class="line"><span class="comment">TRIM(LEADING s1 FROM s)	去掉字符串s开始处的s1</span></span><br><span class="line"><span class="comment">TRIM(TRAILING s1 FROM s)	去掉字符串s结尾处的s1</span></span><br><span class="line"><span class="comment">REPEAT(str, n) 返回str重复n次的结果</span></span><br><span class="line"><span class="comment">SPACE(n) 返回n个空格</span></span><br><span class="line"><span class="comment">STRCMP(s1,s2) 比较字符串s1,s2的ASCII码值的大小</span></span><br><span class="line"><span class="comment">SUBSTR(s,index,len)返回从字符串s的index位置其len个字符，作用与SUBSTRING(s,n,len)、MID(s,n,len)相同</span></span><br><span class="line"><span class="comment">LOCATE(substr,str)返回字符串substr在字符串str中首次出现的位置，作用于POSITION(substrIN str)、INSTR(str,substr)相同。未找到，返回0</span></span><br><span class="line"><span class="comment">ELT(m,s1,s2,…,sn)返回指定位置的字符串，如果m=1，则返回s1，如果m=2，则返回s2，如果m=n，则返回sn</span></span><br><span class="line"><span class="comment">FIELD(s,s1,s2,…,sn) 返回字符串s在字符串列表中第一次出现的位置</span></span><br><span class="line"><span class="comment">FIND_IN_SET(s1,s2)返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分隔的字符串</span></span><br><span class="line"><span class="comment">REVERSE(s) 返回s反转后的字符串</span></span><br><span class="line"><span class="comment">NULLIF(value1,value2)比较两个字符串，如果value1与value2相等，则返回NULL，否则返回value1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="日期和时间函数"><a href="#日期和时间函数" class="headerlink" title="日期和时间函数"></a>日期和时间函数</h4><ol>
<li>获取日期、时间-</li>
</ol>
<table>
<thead>
<tr>
<th align="left">CURDATE() ，CURRENT_DATE() 返回当前日期，只包含年、 月、日</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CURTIME() ， CURRENT_TIME() 返回当前时间，只包含时、 分、秒</td>
</tr>
<tr>
<td align="left">NOW() &#x2F; SYSDATE() &#x2F; CURRENT_TIMESTAMP() &#x2F; LOCALTIME() &#x2F; LOCALTIMESTAMP() 返回当前系统日期和时间</td>
</tr>
</tbody></table>
<ol start="2">
<li>日期与时间戳的转换-</li>
</ol>
<table>
<thead>
<tr>
<th align="left">UNIX_TIMESTAMP() 以UNIX时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() - &gt;1634348884</th>
</tr>
</thead>
<tbody><tr>
<td align="left">UNIX_TIMESTAMP(date) 将时间date以UNIX时间戳的形式返回。</td>
</tr>
<tr>
<td align="left">FROM_UNIXTIME(timestamp) 将UNIX<strong>时间戳的时间转换为普通格式的时间</strong></td>
</tr>
</tbody></table>
<ol start="3">
<li>获取月份、星期、星期天、天数等函数</li>
</ol>
<table>
<thead>
<tr>
<th align="left">YEAR(date) &#x2F; MONTH(date) &#x2F; DAY(date) 返回具体的日期值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">HOUR(time) &#x2F; MINUTE(time) &#x2F; SECOND(time) 返回具体的时间值</td>
</tr>
<tr>
<td align="left">MONTHNAME(date) 返回月份：January，…</td>
</tr>
<tr>
<td align="left">DAYNAME(date) 返回星期几：MONDAY，TUESDAY…..SUNDAY</td>
</tr>
<tr>
<td align="left">WEEKDAY(date) 返回周几，注意，周1是0，周2是1，。。。周日是6</td>
</tr>
<tr>
<td align="left">QUARTER(date) 返回日期对应的季度，范围为1～4</td>
</tr>
<tr>
<td align="left">WEEK(date) ， WEEKOFYEAR(date) 返回一年中的第几周</td>
</tr>
<tr>
<td align="left">DAYOFYEAR(date) 返回日期是一年中的第几天</td>
</tr>
<tr>
<td align="left">DAYOFMONTH(date) 返回日期位于所在月份的第几天</td>
</tr>
<tr>
<td align="left">DAYOFWEEK(date) 返回周几，注意：周日是1，周一是2，。。。周六是7</td>
</tr>
</tbody></table>
<ol start="4">
<li>日期的操作函数</li>
</ol>
<table>
<thead>
<tr>
<th align="left">EXTRACT(type FROM date) 返回指定日期中特定的部分，type指定返回的值</th>
</tr>
</thead>
</table>
<p><img src="https://s1.ax1x.com/2022/03/10/bhOvtA.png" alt="type的取值含义"></p>
<ol start="5">
<li>时间和秒钟转换的函数</li>
</ol>
<table>
<thead>
<tr>
<th align="left">TIME_TO_SEC(time) 将 time 转化为秒并返回结果值。转化的公式为： 小时*3600+分钟 *60+秒</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SEC_TO_TIME(seconds) 将 seconds 描述转化为包含小时、分钟和秒的时间</td>
</tr>
</tbody></table>
<ol start="6">
<li>日期和时间函数的计算-</li>
</ol>
<table>
<thead>
<tr>
<th align="left">DATE_ADD(datetime, INTERVAL expr type)， ADDDATE(date,INTERVAL expr type) 返回与给定日期时间相差INTERVAL时 间段的日期时间</th>
</tr>
</thead>
<tbody><tr>
<td align="left">DATE_SUB(date,INTERVAL expr type)， SUBDATE(date,INTERVAL expr type) 返回与date相差INTERVAL时间间隔的 日期</td>
</tr>
</tbody></table>
<p><img src="https://s1.ax1x.com/2022/03/10/bhXk7Q.png" alt="type的取值含义"></p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhXKXT.png" alt="另一部分的函数"></p>
<ol start="7">
<li>日期的格式化与解析-</li>
</ol>
<table>
<thead>
<tr>
<th align="left">DATE_FORMAT(date,fmt) 按照字符串fmt格式化日期date值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">TIME_FORMAT(time,fmt) 按照字符串fmt格式化时间time值</td>
</tr>
<tr>
<td align="left">GET_FORMAT(date_type,format_type) 返回日期字符串的显示格式</td>
</tr>
<tr>
<td align="left">STR_TO_DATE(str, fmt) 按照字符串fmt对str进行解析，解析为一个日期</td>
</tr>
</tbody></table>
<p><img src="https://s1.ax1x.com/2022/03/10/bhXajK.png" alt="fmt参数常用的格式符"></p>
<p><img src="C:\Users\hcxs1986\AppData\Roaming\Typora\typora-user-images\image-20220302180942261.png" alt="GET_FORMAT函数中date_type和format_type参数取值"></p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhXsNd.png" alt="GET_FORMAT函数中date_type和format_type参数取值"></p>
<h4 id="流程控制函数"><a href="#流程控制函数" class="headerlink" title="流程控制函数"></a>流程控制函数</h4><p> 流程处理函数可以根据不同的条件，执行不同的处理流程</p>
<p>当条件是有范围的，考虑使用case  WHEN</p>
<p>当条件是具体的某个字段，考虑使用case- expr WHEN</p>
<table>
<thead>
<tr>
<th align="left">IF(value,value1,value2) 如果value的值为TRUE，返回value1， 否则返回value2</th>
</tr>
</thead>
<tbody><tr>
<td align="left">IFNULL(value1, value2) 如果value1不为NULL，返回value1，否 则返回value2</td>
</tr>
<tr>
<td align="left">CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2 …. [ELSE resultn] END 相当于Java的if…else if…else…</td>
</tr>
<tr>
<td align="left">CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值1 THEN 值1 …. [ELSE 值n] END 相当于Java的switch…case…</td>
</tr>
</tbody></table>
<hr>
<h3 id="加密与解密函数"><a href="#加密与解密函数" class="headerlink" title="加密与解密函数"></a>加密与解密函数</h3><p>(了解)</p>
<p>password(str)、encode()、decode()在MySQL8.0中被弃用</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhXRjf.png" alt="加密与解密函数"></p>
<h3 id="MySQL信息函数"><a href="#MySQL信息函数" class="headerlink" title="MySQL信息函数"></a>MySQL信息函数</h3><p>(了解)</p>
<table>
<thead>
<tr>
<th align="left">VERSION() 返回当前MySQL的版本号</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CONNECTION_ID()   返回当前MySQL服务器的连接数</td>
</tr>
<tr>
<td align="left">DATABASE()，SCHEMA()   返回MySQL命令行当前所在的数据库</td>
</tr>
<tr>
<td align="left">USER()，CURRENT_USER()、SYSTEM_USER()， SESSION_USER()   返回当前连接MySQL的用户名，返回结果格式为 “主机名@用户名</td>
</tr>
<tr>
<td align="left">CHARSET(value)   返回字符串value自变量的字符集</td>
</tr>
<tr>
<td align="left">COLLATION(value)   返回字符串value的比较规则</td>
</tr>
</tbody></table>
<h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><p>(了解)</p>
<p>对于FORMAT(value,n)的函数：如果n的值小于或者等于0，则只保留整数部分</p>
<table>
<thead>
<tr>
<th align="left">FORMAT(value,n) 返回对数字value进行格式化后的结果数据。n表示 四舍五入 后保留 到小数点后n位</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CONV(value,from,to) 将value的值进行不同进制之间的转换</td>
</tr>
<tr>
<td align="left">INET_ATON(ipvalue) 将以点分隔的IP地址转化为一个数字</td>
</tr>
<tr>
<td align="left">INET_NTOA(value) 将数字形式的IP地址转化为以点分隔的IP地址</td>
</tr>
<tr>
<td align="left">BENCHMARK(n,expr) 将表达式expr重复执行n次。用于测试MySQL处理expr表达式所耗费 的时间</td>
</tr>
<tr>
<td align="left">CONVERT(value USING char_code) 将value所使用的字符编码修改为char_code</td>
</tr>
</tbody></table>
<h3 id="多行函数-聚合函数"><a href="#多行函数-聚合函数" class="headerlink" title="多行函数(聚合函数)"></a>多行函数(聚合函数)</h3><p>聚合函数作用于一组数据，并对一组数据最终只会返回一个值</p>
<ol>
<li>常见的聚合函数</li>
</ol>
<ul>
<li>AVG &#x2F; SUM（只适用于数值类型的字段或变量）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),<span class="built_in">SUM</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ul>
<li>MAX &#x2F; MIN（适用于数值类型、字符串类型、日期时间类型的字段或变量）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#MAX <span class="operator">/</span> MIN</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(last_name),<span class="built_in">MIN</span>(last_name)</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(hire_date),<span class="built_in">MIN</span>(hire_date)</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>COUNT</p>
<p>作用：计算指定字段在查询结构中出现的个数，不包含null</p>
</li>
</ul>
<p>​		       计算表中有多少条数据的方式  公式AVG &#x3D; SUM &#x2F; COUNT</p>
<p>​				①COUNT(*)</p>
<p>​				②COUNT(1)；相当于每遍历一行就标记一个1，最终统计标记了多少个1，内部填2也是同个结果</p>
<p>​				③COUNT(具体字段)；不一定完全正确，count统计的只是不为null的行，有些字段中数据为null，count不统计在内</p>
<p>补充：在统计表中的记录数方面</p>
<p>​			如果使用的是MyISAM 存储引擎，这三个的效率都是相同的，都是O(1)</p>
<p>​			但如果使用的是InnoDB 存储引擎，则效率就不同：COUNT(*) &#x3D; COUNT(1) &gt; COUNT(具体字段)</p>
<ol start="2">
<li>GROUP BY的使用</li>
</ol>
<p><strong>①在SELECT中出现的非组函数的字段必须声明在GROUP BY中，而在GROUP BY中声明的字段则不一定需要出现在SELECT中</strong></p>
<p><strong>②GROUP BY 声明在FROM 和 WHERE后面，ORDER BY 和 LIMIT 的前面</strong></p>
<p>③(了解)MySQL中GROUP BY中使用 WITH ROLLUP  </p>
<p>​	在使用ROLLUP  后，不能同时使用ORDER BY 关键字进行排序，ROLLUP 和 ORDER BY 是相互排斥的，造成报错</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#查询各个department_id,job_id的平均工资</span><br><span class="line">#方式一:</span><br><span class="line">#非组函数的字段：department_id,job_id  组函数字段：salary</span><br><span class="line"><span class="keyword">SELECT</span> department_id,job_id,<span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span>  department_id,job_id;</span><br><span class="line">#两种方式的结果都是相同，只是分组的先后顺序有所变化</span><br><span class="line">#方式二：</span><br><span class="line"><span class="keyword">SELECT</span> job_id,department_id,<span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span>  job_id,department_id;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>Having的使用</li>
</ol>
<p>​		作用：用来过滤数据</p>
<p>​		<strong>①如果过滤条件使用了聚合函数，则必须使用HAVING来替代WHERE，否则，报错</strong></p>
<p>​	    <strong>②HAVING必须声明在 GROUP BY 的后面</strong></p>
<p>​		补充：一般在MySQL中使用HAVING 的前提是已经 使用了 GROUP BY ，</p>
<p>​		否则 意义不大，GROUP BY的结果是多条的，HAVING 起过滤作用，少了GROUP BY结果只有一条也就没必要进行过滤了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">Having</span>的使用</span><br><span class="line"><span class="keyword">SELECT</span> department_id,<span class="built_in">MAX</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MAX</span>(salary) <span class="operator">&gt;</span> <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line">#查询部门id为<span class="number">10</span>，<span class="number">20</span>，<span class="number">30</span>，<span class="number">40</span>这<span class="number">4</span>个部门中最高工资比<span class="number">10000</span>高的部门信息</span><br><span class="line"><span class="keyword">SELECT</span> department_id,<span class="built_in">MAX</span>(salary) max_salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">#<span class="keyword">where</span> department_id <span class="keyword">in</span> (<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> max_salary <span class="operator">&gt;</span> <span class="number">10000</span> <span class="keyword">AND</span> department_id <span class="keyword">IN</span> (<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>);	</span><br></pre></td></tr></table></figure>

<p>​	针对代码块内的查询练习：<strong>当过滤条件中有聚合函数时，则此过滤条件必须声明在HAVING中</strong>		</p>
<p>​											      <strong>当过滤条件中没有聚合函数时，过滤条件声明在哪都可以，但声明在WHERE中为好，其效率较高</strong></p>
<p>HAVING 与 WHERE 的比较</p>
<p>①在适用范围上，Having的适用范围上更广</p>
<p>②在过滤条件没有聚合函数，此时where的效率要更高</p>
<p>​	where先连接后筛选，数据更小；havaing则是先筛选后连接</p>
<ol start="4">
<li>SQL底层执行原理</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">SQL语句的完整结构</span></span><br><span class="line"><span class="comment">SQL92语法</span></span><br><span class="line"><span class="comment">SELECT ...,...,..(存在聚合函数)</span></span><br><span class="line"><span class="comment">FROM ...,...</span></span><br><span class="line"><span class="comment">WHERE 多表的连接条件 AND 不包含聚合函数的过滤条件</span></span><br><span class="line"><span class="comment">GROUP BY ...,...</span></span><br><span class="line"><span class="comment">HAVING 包含聚合函数的过滤条件</span></span><br><span class="line"><span class="comment">ORDER BY ...,...(DESC,ASC)</span></span><br><span class="line"><span class="comment">LIMIT ....</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">SQL99语法</span></span><br><span class="line"><span class="comment">#在SELECT中，除了GROUP BY 和 LIMIT 之外，其他位置都可以声明子查询！</span></span><br><span class="line"><span class="comment">SELECT ...,...,..(存在聚合函数)</span></span><br><span class="line"><span class="comment">FROM ...,...(LEFT / RIGHT) JOIN ...,ON  多表的连接条件</span></span><br><span class="line"><span class="comment">...(LEFT / RIGHT) JOIN ...,ON  多表的连接条件</span></span><br><span class="line"><span class="comment">WHERE 不包含聚合函数的过滤条件</span></span><br><span class="line"><span class="comment">GROUP BY ...,...</span></span><br><span class="line"><span class="comment">HAVING 包含聚合函数的过滤条件</span></span><br><span class="line"><span class="comment">ORDER BY ...,...(DESC,ASC)</span></span><br><span class="line"><span class="comment">LIMIT ....</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>SQL语句执行的先后顺序</p>
<p>FROM … , …–&gt; ON  –&gt;(LEFT &#x2F; RIGHT)   JOIN  … –&gt;  WHERE   –&gt;  GROUP BY–&gt; HAVING –&gt;SELECT   –&gt;  DISTINCT   –&gt;  ORDER BY   –&gt;  LIMIT</p>
</li>
</ul>
<hr>
<h2 id="不相关子查询"><a href="#不相关子查询" class="headerlink" title="不相关子查询"></a>不相关子查询</h2><p>分为：外查询(主查询) 	 内查询(子查询)</p>
<p>注意事项：</p>
<ul>
<li><strong>子查询要包括在括号内</strong></li>
<li><strong>一般将子查询放在比较条件右侧，可读性更好</strong></li>
<li><strong>单行操作符对于单行子查询，多行操作符对应多行子查询</strong></li>
</ul>
<ol>
<li><p>子查询的分类</p>
<p>①从内查询的返回的结果的条目数</p>
<p>  单行子查询  和  多行子查询</p>
<p>②内查询是否被执行多次</p>
<p> 相关子查询 和 不相关子查询</p>
<p>可以理解为不相关子查询返回的结果类型是固定，而相关子查询还要根据主查询的数据进行一定的判断，从而造成被执行多次</p>
</li>
</ol>
<h3 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a>单行子查询</h3><p>单行比较操作符：比较特殊的一个    &lt;&gt;  此操作符是不等于</p>
<p>①单行子查询中的空值问题：<strong>子查询如果返回null(子查询不返回任何行)，即找不到，而主查询就会出现字段空白的情况</strong></p>
<p>②非法使用子查询：子查询中返回了多行数据，但主查询使用了单行比较符</p>
<h3 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a>多行子查询</h3><p>多行比较操作符</p>
<table>
<thead>
<tr>
<th>IN 等于列表中的任意一个</th>
</tr>
</thead>
<tbody><tr>
<td>ANY 需要和单行比较操作符一起使用，和子查询返回的某一个值比较</td>
</tr>
<tr>
<td>ALL 需要和单行比较操作符一起使用，和子查询返回的所有值比较</td>
</tr>
<tr>
<td>SOME 实际上是ANY的别名，作用相同，一般常使用ANY</td>
</tr>
</tbody></table>
<p><strong>在使用IN 或者 NOT IN 的位置通常可以考虑使用EXISTS 与 NOT EXISTS 代替</strong></p>
<p>①多行子查询中的空值问题：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#空值问题</span><br><span class="line">#<span class="keyword">Not</span> <span class="keyword">in</span> 实际上就是 <span class="operator">&lt;&gt;</span><span class="keyword">ALL</span> 而用大于或小于来比较<span class="keyword">Null</span>值的话，都返回<span class="keyword">null</span>的。(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">			<span class="keyword">SELECT</span> manager_id</span><br><span class="line">			<span class="keyword">FROM</span> employees</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>子查询嵌套例题</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">10.</span>查询平均工资最高的 job 信息</span><br><span class="line">#方法一</span><br><span class="line">#①查询各个job_id的平均工资</span><br><span class="line">#②将结果集中的  <span class="built_in">AVG</span>(salary 当成一个字段并构建新的表, 并查出avg_sal字段中的最大值</span><br><span class="line">#③查询employees表中的各个job_id的平均工资等于此最大值，并返回此部门的job_id</span><br><span class="line">#④根据此job_id去 jobs 里面对比两表相同的 job_id 返回此部门信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> job_id</span><br><span class="line">		<span class="keyword">FROM</span> employees</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line">		<span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary) <span class="operator">=</span> (</span><br><span class="line">					<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(avg_sal)</span><br><span class="line">					<span class="keyword">FROM</span> (</span><br><span class="line">						<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) avg_sal</span><br><span class="line">						<span class="keyword">FROM</span> employees </span><br><span class="line">						<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line">					     ) t_avg</span><br><span class="line">					)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">#方式二</span><br><span class="line">#job_id的平均工资<span class="operator">&lt;=</span> <span class="keyword">ALL</span>，即为部门的平均工资等于所有部门的平均工资的最小值		</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> job_id</span><br><span class="line">		<span class="keyword">FROM</span> employees</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line">		<span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary) <span class="operator">&gt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">					<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line">					<span class="keyword">FROM</span> employees </span><br><span class="line">					<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id    </span><br><span class="line">					)</span><br><span class="line"></span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">#方式三 </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> job_id</span><br><span class="line">		<span class="keyword">FROM</span> employees</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line">		<span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary) <span class="operator">=</span> (</span><br><span class="line">					<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) avg_ssal</span><br><span class="line">					<span class="keyword">FROM</span> employees </span><br><span class="line">					<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id </span><br><span class="line">					#利用排序显示最高的第一行数据，</span><br><span class="line">					#用这个数据去跟<span class="built_in">AVG</span>(salary)比较，得到job_id</span><br><span class="line">					#再根据job_id去jobs表中筛出数据 </span><br><span class="line">					<span class="keyword">ORDER</span> <span class="keyword">BY</span> avg_ssal <span class="keyword">DESC</span> </span><br><span class="line">					LIMIT <span class="number">0</span>,<span class="number">1</span> </span><br><span class="line">					)</span><br><span class="line"></span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">#方式四 </span><br><span class="line"><span class="keyword">SELECT</span> j.<span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs j,#将下方的排序后得到的唯独的一行数据当成一张表，</span><br><span class="line">	    #再根据jobs和此表的job_id比较得到数据</span><br><span class="line">	   (<span class="keyword">SELECT</span> job_id,<span class="built_in">AVG</span>(salary) avg_ssal </span><br><span class="line">	   <span class="keyword">FROM</span> employees </span><br><span class="line">	   <span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id </span><br><span class="line">	   <span class="keyword">ORDER</span> <span class="keyword">BY</span> avg_ssal <span class="keyword">DESC</span></span><br><span class="line">	   LIMIT <span class="number">0</span>,<span class="number">1</span> ) t_jobs </span><br><span class="line">	  </span><br><span class="line"><span class="keyword">WHERE</span> j.job_id <span class="operator">=</span> t_jobs.job_id;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="相关子查询"><a href="#相关子查询" class="headerlink" title="相关子查询"></a>相关子查询</h2><p>在SELECT中，除了GROUP BY 和 LIMIT 之外，其他位置都可以声明子查询！</p>
<h3 id="EXISTS-与-NOT-EXISTS关键字"><a href="#EXISTS-与-NOT-EXISTS关键字" class="headerlink" title="EXISTS 与 NOT EXISTS关键字"></a>EXISTS 与 NOT EXISTS关键字</h3><p><strong>EXISTS 子查询 找到的提交	&#x2F;	NOT EXISTS 子查询中 找不到的提交</strong></p>
<p>关联子查询通常也会和 EXISTS操作符一起来使用，用来检查在子查询中是否存在满足条件的行。 </p>
<p>如果在子查询中不存在满足条件的行:</p>
<ul>
<li>条件返回 FALSE 继续在子查询中查找</li>
</ul>
<p>如果在子查询中存在满足条件的行 :</p>
<ul>
<li><p>不在子查询中继续查找 条件返回 TRUE </p>
<p><strong>NOT EXISTS关键字表示如果不存在某种条件，则返回TRUE，否则返回FALSE。</strong></p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#使用<span class="keyword">IN</span></span><br><span class="line">#从employees表中找到管理者的id，再根据此id在主查询中逐个遍历，相同即为管理者</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees </span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="keyword">IN</span> (</span><br><span class="line">			<span class="keyword">SELECT</span> manager_id</span><br><span class="line">			<span class="keyword">FROM</span> employees </span><br><span class="line">			);</span><br><span class="line">			</span><br><span class="line">#使用<span class="keyword">EXISTS</span></span><br><span class="line">#从employees表中取出一条数据</span><br><span class="line">#判断此数据的employee_id 和 e1表中的manager_id是否一样</span><br><span class="line">#一样即为管理者，输出此行</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,salary,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">			<span class="keyword">SELECT</span> manager_id</span><br><span class="line">			<span class="keyword">FROM</span> employees e1</span><br><span class="line">			<span class="keyword">WHERE</span> e.`employee_id` <span class="operator">=</span> e1.`manager_id`</span><br><span class="line">			);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="创建和管理"><a href="#创建和管理" class="headerlink" title="创建和管理"></a>创建和管理</h2><p><strong>从系统架构的层次上看，MySQL 数据库系统从大到小依次是 数据库服务器 、 数据库 、 数据表 、数据表的 行与列 。</strong></p>
<h3 id="标识符命名规则"><a href="#标识符命名规则" class="headerlink" title="标识符命名规则"></a>标识符命名规则</h3><ul>
<li><p>数据库名、表名不得超过30个字符，变量名限制为29个 </p>
</li>
<li><p>必须只能包含 A–Z, a–z, 0–9, _共63个字符 数据库名、表名、字段名等对象名中间不要包含空格 </p>
</li>
<li><p>同一个MySQL软件中，数据库不能同名；同一个库中，表不能重名；</p>
</li>
<li><p>同一个表中，字段不能重名 必须保证你的字段没有和保留字、数据库系统或常用方法冲突。如果坚持使用，请在SQL语句中使 用&#96;（着重号）引起来 </p>
</li>
<li><p>保持字段名和类型的一致性：在命名字段并为其指定数据类型的时候一定要保证一致性，假如数据 类型在一个表里是整数，那在另一个表里可就别变成字符型了</p>
</li>
</ul>
<h3 id="数据库-的创建与管理"><a href="#数据库-的创建与管理" class="headerlink" title="数据库 的创建与管理"></a>数据库 的创建与管理</h3><ol>
<li>创建数据库的方式</li>
</ol>
<ul>
<li><p>方式一 ：使用默认字符集创建<br>CREATE DATABASE  数据库名</p>
</li>
<li><p>方式二 ：显式指明创建数据库所用的字符集</p>
<p>CREATE DATABASE  数据库名  CHARACTER SET ‘GBK’</p>
</li>
<li><p>方式三 ：如果创建的数据库已经存在，则创建失败，但不报错 （推荐方式）</p>
<p>CREATE DATABASE IF NOT EXISTS 数据库名 CHARACTER SET ‘GBK’</p>
</li>
</ul>
<ol start="2">
<li>数据库的管理</li>
</ol>
<p>​		查看当前连接中所有的数据库：show database</p>
<p>​		指定使用某个数据库：use database</p>
<p>​		查看当前连接数据库的表：show tables</p>
<p>​		查看当前使用的数据库：select database() from dual</p>
<p>​		查看指定数据下的表：show tables from 数据库名</p>
<p>​		查看已创建的数据库结构 ：show create database 数据库名</p>
<p>​		查看表的结构：desc 数据表名</p>
<ol start="3">
<li>修改数据库</li>
</ol>
<p>​		更改数据库的字符集：ALTER DATABASE 数据库名 CHARACTER SET 字符集; #比如：gbk、utf8等</p>
<ol start="4">
<li><p>删除数据库</p>
<ul>
<li><p>方式一：DROP DATABASE  数据库名;</p>
</li>
<li><p>方式二：如果要删除的数据库不存在，则删除失败，但不报错 （推荐方式）</p>
<p>DROP DATABASE IF  EXISTS 数据库名</p>
</li>
</ul>
</li>
</ol>
<h3 id="数据表-的创建和管理"><a href="#数据表-的创建和管理" class="headerlink" title="数据表 的创建和管理"></a>数据表 的创建和管理</h3><ol>
<li><p>创建数据表的方式</p>
<p>①方式一：使用VARCHAR来定义字符串时，必须在使用VARCHAR时指明其长度</p>
<p>​	如果创建表时没有使用指定的字符集，则默认使用表所在的数据库的字符集</p>
</li>
</ol>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> test_tab (</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">test_name <span class="type">VARCHAR</span>(<span class="number">15</span>),#使用<span class="type">VARCHAR</span>来定义字符串时，必须在使用<span class="type">VARCHAR</span>时指明其长度</span><br><span class="line">hire_date <span class="type">DATE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#查看表的语句结构</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_tab;</span><br></pre></td></tr></table></figure>

<p>​		②方式二：基于现有的表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table </span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#查询语句中字段的别名可以作为新创建的表的字段名称</span><br><span class="line">#通过<span class="keyword">select</span>查询语句将此结果集作为新建表的内容</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_t</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id id,e.last_name last_n,d.department_name d_name</span><br><span class="line"><span class="keyword">FROM</span> employees e <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改数据表  	ALTER TABLE</li>
</ol>
<p>	</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#①添加字段</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line"><span class="keyword">ADD</span> salary <span class="keyword">DOUBLE</span>(<span class="number">10</span>,<span class="number">2</span>); #默认添加成最后的一个字段</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab </span><br><span class="line"><span class="keyword">ADD</span> phone_num <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">FIRST</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line"><span class="keyword">ADD</span> email <span class="type">VARCHAR</span>(<span class="number">30</span>) AFTER test_name;</span><br><span class="line"></span><br><span class="line">#②修改字段：数据类型、长度等等</span><br><span class="line">#数据类型一般不做修改，因为无法保证修改后原数据的是否适用于现在的类型</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line">MODIFY test_name <span class="type">VARCHAR</span>(<span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#③重命名字段</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line">CHANGE salary month_salary <span class="keyword">DOUBLE</span>(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line">CHANGE email my_email <span class="type">VARCHAR</span>(<span class="number">25</span>); #在重命名字段的同时还能够更改长度</span><br><span class="line"></span><br><span class="line">#④删除字段</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> my_email;#删除的是某一列</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>重命名数据表</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#方式一(推荐使用)</span><br><span class="line">RENAME <span class="keyword">TABLE</span> test_tab</span><br><span class="line"><span class="keyword">TO</span> test_table;</span><br><span class="line"></span><br><span class="line">#方式二</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_tab</span><br><span class="line">RENAME <span class="keyword">TO</span> test_t;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>删除数据表</p>
<p><strong>将表的结构和表的数据一起删除，释放表的空间</strong></p>
<p><strong>DROP TABLE IF EXISTS test_t;</strong></p>
</li>
<li><p>清空数据表</p>
<p><strong>清空表中的所有数据，但表的结构还保留</strong></p>
<p><strong>TRUNCATE TABLE employees_copy;</strong></p>
</li>
</ol>
<hr>
<h2 id="DCL、DDL、DML"><a href="#DCL、DDL、DML" class="headerlink" title="DCL、DDL、DML"></a>DCL、DDL、DML</h2><h3 id="DCL中的-commit-和-rollback"><a href="#DCL中的-commit-和-rollback" class="headerlink" title="DCL中的 commit 和 rollback"></a>DCL中的 commit 和 rollback</h3><p>commit：提交数据。（数据保存在数据库中，数据不支持回滚）</p>
<p>rollback：回滚数据。（执行此关键字实现数据的回滚，回滚到最近的一次COMMIT之后）</p>
<h3 id="TRUNCATE-TABLE-与-DELETE-FROM"><a href="#TRUNCATE-TABLE-与-DELETE-FROM" class="headerlink" title="TRUNCATE TABLE 与 DELETE FROM"></a>TRUNCATE TABLE 与 DELETE FROM</h3><p>TRUNCATE TABLE：执行此操作，会将表的数据全部清除，且数据是不支持回滚的</p>
<p>DELETE FROM ：执行此操作，表数据也会全部清除，但可以选择性的清除部分数据。且其数据是可以实现回滚的</p>
<p>补：TRUNCATE TABLE要比DELETE FROM要快，因其不需要考虑数据备份的问题，所以使用的系统和事务日志资源少，</p>
<p>​		但也正是如此，使用TRUNCATE有可能造成事故，如一小心误删核心数据而无法恢复，DELETE 则可以避免这个问题</p>
<h3 id="DDL-与-DML"><a href="#DDL-与-DML" class="headerlink" title="DDL 与 DML"></a>DDL 与 DML</h3><p>以DDL 与 DML为首执行的区别</p>
<p>①DDL的操作一旦执行，就不可以回滚。且指令SET autocommit &#x3D; FALSE 对DDL的操作无效</p>
<p>​	在每次DDL执行完成之后都会自动执行一次COMMIT，且此COMMIT是不受上述指令的影响</p>
<p>②DML的操作在默认情况下，一旦执行也是不可回滚的，</p>
<p>​	但如果在执行之前，曾执行过  <strong>指令SET autocommit &#x3D; FALSE ，则此时的操作是可回滚的</strong></p>
<hr>
<h2 id="DML的增删改"><a href="#DML的增删改" class="headerlink" title="DML的增删改"></a>DML的增删改</h2><p>无论是添加、更新、删除的操作都有可能会因为约束的作用导致操作失败</p>
<p>DML默认情况下，执行完以后都会commit自动提交数据，</p>
<p>如果不希望其自动提交数据需要使用 指令 SET autocommit &#x3D; FALSE。</p>
<h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><ul>
<li>方式一：一条一条的添加数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#单条逐个添加</span><br><span class="line">#方式一 没有指明要添加的字段</span><br><span class="line">#此方式添加数据需要按照声明字段的先后顺序添加</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> the_table</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;2012-12-21&#x27;</span>,<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line">#方式二 指明要添加的字段(推荐)</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> the_table(id,hire_date,salary,the_name)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">2</span>,<span class="string">&#x27;2012-12-21&#x27;</span>,<span class="number">2000</span>,<span class="string">&#x27;merry&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#没有进行赋值的salary的值为<span class="keyword">null</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> the_table(id,hire_date,the_name)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">3</span>,<span class="string">&#x27;2012-12-21&#x27;</span>,<span class="string">&#x27;merry&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#方式三 推荐</span><br><span class="line">#同时插入多条数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> the_table(id,the_name,salary)</span><br><span class="line"><span class="keyword">VALUES</span> </span><br><span class="line">(<span class="number">4</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">2000</span>),</span><br><span class="line">(<span class="number">5</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="number">6000</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>方式二：将查询结果插入表中</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> the_table(id,the_name,salary,hire_date)</span><br><span class="line">#一个查询语句</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary,hire_date#此处的字段要和添加到上表的字段相互对应</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">60</span>,<span class="number">70</span>);</span><br></pre></td></tr></table></figure>

<p>补充说明：the_table表中要添加数据的字段的长度不能小于employees表中查询的字段长度，否则有添加失败的可能</p>
<h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><p>使用的格式：UPDATE … SET … WHERE </p>
<p>在where 添加条件 可以实现批量修改的功能 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#将表中id为<span class="number">5</span>的hire_date设为当前系统时间</span><br><span class="line"><span class="keyword">UPDATE</span> the_table</span><br><span class="line"><span class="keyword">SET</span> hire_date <span class="operator">=</span> SYSDATE()</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p>使用的格式：DELETE  FROM … WHERE </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> the_table</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="MySQL8-新特性：计算列"><a href="#MySQL8-新特性：计算列" class="headerlink" title="MySQL8 新特性：计算列"></a>MySQL8 新特性：计算列</h3><p>计算列：某一列的值是通过别的列计算得来的</p>
<p>例如：a列值为1，b列值为2，c列的值定义为 a+b ，则c列称为计算列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test1(</span><br><span class="line">a <span class="type">INT</span>,</span><br><span class="line">b <span class="type">INT</span>,</span><br><span class="line">c <span class="type">INT</span> GENERATED ALWAYS <span class="keyword">AS</span> (a <span class="operator">+</span> b) VIRTUAL # c即为计算列</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="MySQL的数据类型"><a href="#MySQL的数据类型" class="headerlink" title="MySQL的数据类型"></a>MySQL的数据类型</h2><p><strong>写在前头，一般在定义数据类型，确定是整数，使用INT；确定是小数，使用DECIMAY(M精度,D标度)；确定是日期和时间，使用DATETIME；</strong></p>
<p>虽然存储空间占用变大了，但是数据的安全和可靠性得到了一定的保证</p>
<h3 id="整数类型-整形"><a href="#整数类型-整形" class="headerlink" title="整数类型(整形)"></a>整数类型(整形)</h3><p><strong>整数类型一共有 5 种，包括 TINYINT、SMALLINT、MEDIUMINT、INT（INTEGER）和 BIGINT</strong></p>
<table>
<thead>
<tr>
<th align="center">整数类型</th>
<th align="center">字节</th>
<th align="center">有符号数取值范围</th>
<th align="center">无符号数取值范围</th>
</tr>
</thead>
<tbody><tr>
<td align="center">TINYINT</td>
<td align="center">1</td>
<td align="center">-128~127</td>
<td align="center">0~255</td>
</tr>
<tr>
<td align="center">SMALLINT</td>
<td align="center">2</td>
<td align="center">-32768~32767</td>
<td align="center">0~65535</td>
</tr>
<tr>
<td align="center">MEDIUMINT</td>
<td align="center">3</td>
<td align="center">-8388608~8388607</td>
<td align="center">0~16777215</td>
</tr>
<tr>
<td align="center">INT、INTEGER</td>
<td align="center">4</td>
<td align="center">-2147483648~2147483647</td>
<td align="center">0~4294967295</td>
</tr>
<tr>
<td align="center">BIGINT</td>
<td align="center">8</td>
<td align="center">-9223372036854775808~9223372036854775807</td>
<td align="center">0~18446744073709551615</td>
</tr>
</tbody></table>
<p>在mysql 5.7中 desc table 所显示的字段类型后面括号内的数实际上是 数据的显示宽度，但在MySQL 8.0中已经不考虑使用。</p>
<p>ZEROFILL：当insert的值不足5位时，使用0填充 ②当使用ZEROFILL，自动添加UNSIGNED</p>
<p>UNSIGNED : 无符号类型（非负），默认是正数。int类型默认显示宽度为int(11)，无符号int类型默认显示宽度为int(10)。</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhXLvV.png" alt="SQLyog的运行结果"></p>
<ul>
<li>mysql 5.7的演示</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_int1(</span><br><span class="line">i1 <span class="type">INT</span>,</span><br><span class="line">i2 <span class="type">INT</span>(<span class="number">5</span>),</span><br><span class="line">i3 <span class="type">INT</span>(<span class="number">5</span>) ZEROFILL  #①显示宽度为<span class="number">5</span>。当<span class="keyword">insert</span>的值不足<span class="number">5</span>位时，使用<span class="number">0</span>填充 ②当使用ZEROFILL，自动添加UNSIGNED</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_int1(i3)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">123</span>),(<span class="number">123456</span>);#数据的显示情况 <span class="number">123</span> <span class="comment">--&gt; 00123,123456--&gt;123456</span></span><br></pre></td></tr></table></figure>

<p>TINYINT ：一般用于枚举数据，比如系统设定取值范围很小且固定的场景。</p>
<p> SMALLINT ：可以用于较小范围的统计数据，比如统计工厂的固定资产库存数量等。 </p>
<p>MEDIUMINT ：用于较大整数的计算，比如车站每日的客流量等。</p>
<p>INT、INTEGER ：取值范围足够大，一般情况下不用考虑超限问题，用得最多。比如商品编号。 </p>
<p>BIGINT ：只有当你处理特别巨大的整数时才会用到。比如双十一的交易量、大型门户网站点击量、证 券公司衍生产品持仓等。</p>
<h3 id="浮点类型"><a href="#浮点类型" class="headerlink" title="浮点类型"></a>浮点类型</h3><p>浮点数和定点数类型的特点是可以 处理小数 </p>
<p><strong>MySQL支持的浮点数类型，分别是 FLOAT、DOUBLE、REAL。</strong></p>
<p>float表示单精度浮点数，double表示双精度浮点数，read默认是double，除非使用“ REAL_AS_FLOAT ”将read改为默认float</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhjp59.png" alt="浮点类型"></p>
<p>MySQL 存储浮点数的格式为： 符号(S) 、 尾数(M) 和 阶码(E) 。</p>
<p>因此，无论有没有符号，MySQL 的浮点数都会存储表示符号的部分。</p>
<p><strong>浮点数的无符号数取值范围，其实就是有符号数取值范围大于等于零的部分。</strong></p>
<p>在MySQL 8.0中明确不推荐使用：MySQL允许使用 非标准语法 （不推荐使用，数据迁移也许存在问题）</p>
<p>格式：FLOAT(M,D) 或 DOUBLE(M,D) 。</p>
<p>这里，M称为 精度 ，D称为 标度 。(M,D)中 M&#x3D;整数位+小数 位，D&#x3D;小数位。 D&lt;&#x3D;M&lt;&#x3D;255，0&lt;&#x3D;D&lt;&#x3D;30。 </p>
<p>例如，定义为FLOAT(5,2)的一个列可以显示为-999.99-999.99。如果超过这个范围会报错。</p>
<p><strong>补充：浮点数是存在精度损失的，因此浮点数是不准确的，所以我们要避免使用“&#x3D;”来 判断两个数是否相等。</strong></p>
<h3 id="定点数类型"><a href="#定点数类型" class="headerlink" title="定点数类型"></a>定点数类型</h3><ul>
<li><p>MySQL中的定点数类型只有 DECIMAL 一种类型。</p>
</li>
<li><p>DECIMAL(M,D)的最大取值范围与DOUBLE类型一样，但是有效的数据范围是由M和D决定的。</p>
</li>
<li><p><strong>定点数在MySQL内部是以 字符串 的形式进行存储，因此它是精准的</strong></p>
</li>
<li><p>当DECIMAL类型不指定精度和标度时，其默认为DECIMAL(10,0)。</p>
<p>但是，当数据的精度超出了定点数类型的 精度范围时，则MySQL同样会进行四舍五入处理。</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">数据类型</th>
<th align="left">字节数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">DECIMAL(M,D),DEC,NUMERIC</td>
<td align="left">M+2字节</td>
<td align="left">有效范围由M和D决定</td>
</tr>
</tbody></table>
<p>浮点数 与 定点数 的区别：</p>
<p>①浮点数相对于定点数的优点是在长度一定的情况下，浮点类型取值范围大，但是不精准，适用 于需要取值范围大，又可以容忍微小误差的科学计算场景（比如</p>
<p>计算化学、分子建模、流体动 力学等） </p>
<p>②定点数类型取值范围相对小，但是精准，没有误差，适合于对精度要求极高的场景 （比如涉 及金额计算的场景）</p>
<h3 id="位类型-Bit"><a href="#位类型-Bit" class="headerlink" title="位类型(Bit)"></a>位类型(Bit)</h3><ul>
<li><p>BIT类型中存储的是二进制值，类似010110。</p>
</li>
<li><p>BIT类型，如果没有指定(M)，默认是1位。</p>
<p>这个1位，表示只能存1位的二进制值。这里(M)是表示二进制的 位数，位数最小值为1，最大值为64。</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">二进制字符串类型</th>
<th align="left">长度</th>
<th align="left">长度范围</th>
<th align="left">占用空间</th>
</tr>
</thead>
<tbody><tr>
<td align="left">BIT(M)</td>
<td align="left">M</td>
<td align="left">1 &lt;&#x3D; M &lt;&#x3D; 64</td>
<td align="left">约为(M + 7)&#x2F;8个字节</td>
</tr>
</tbody></table>
<ul>
<li>注意：在向BIT类型的字段中插入数据时，一定要确保插入的数据在BIT类型支持的范围内。</li>
<li>使用b+0查询数据时，可以直接查询出存储的十进制数据的值。</li>
</ul>
<hr>
<h3 id="日期和时间类型"><a href="#日期和时间类型" class="headerlink" title="日期和时间类型"></a>日期和时间类型</h3><ul>
<li>YEAR 类型通常用来表示年 </li>
<li>DATE 类型通常用来表示年、月、日 </li>
<li>TIME 类型通常用来表示时、分、秒 </li>
<li>DATETIME 类型通常用来表示年、月、日、时、分、秒 </li>
<li>TIMESTAMP 类型通常用来表示带时区的年、月、日、时、分、秒</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/03/10/bhjCCR.png" alt="相关格式"></p>
<h4 id="YEAR类型"><a href="#YEAR类型" class="headerlink" title="YEAR类型"></a>YEAR类型</h4><p>Year类型所占存储空间最小，只需要 1 个字节的存储空间</p>
<p>在MySQL中YEAR的存储格式：</p>
<ul>
<li><p><strong>以4位字符串或数字格式表示YEAR类型，其格式为YYYY，最小值为1901，最大值为2155。</strong></p>
</li>
<li><p>(从MySQL5.5.27开始，2位格式的YEAR已经不推荐使用) 以2位字符串格式表示YEAR类型，最小值为00，最大值为99。</p>
<p>当取值为01到69时，表示2001到2069；</p>
<p>当取值为70到99时，表示1970到1999；</p>
<p>当取值整数的0或00添加的话，那么是0000年； </p>
<p>当取值是日期&#x2F;字符串的’0’添加的话，是2000年。</p>
</li>
</ul>
<h4 id="DATE类型"><a href="#DATE类型" class="headerlink" title="DATE类型"></a>DATE类型</h4><p>DATE类型占用 3个字节 的存储空间</p>
<p><strong>在MySQL中DATE的存储格式： YYYY-MM-DD ，DATE类型表示日期，没有时间部分</strong></p>
<ul>
<li>使用 CURRENT_DATE() 或者 NOW() 函数，会插入当前系统的日期。</li>
</ul>
<h4 id="TIME类型"><a href="#TIME类型" class="headerlink" title="TIME类型"></a>TIME类型</h4><p>TIME类型占用 3个字节 的存储空间</p>
<p><strong>在MySQL中DATE的存储格式：</strong></p>
<ul>
<li><strong>‘ D HH:MM:SS’ 、’ HH:MM:SS ‘、’ HH:MM ‘、’ D HH:MM ‘、’ D HH ‘或’ SS ‘格式</strong></li>
</ul>
<p>其中D表示天，其最小值为0，最大值为34。</p>
<p>如果使用带有D格式的字符串 插入TIME类型的字段时，D会被转化为小时，计算格式为D*24+HH。</p>
<p>当使用带有冒号并且不带D的字符串 表示时间时，表示当天的时间，比如12:10表示12:10:00，而不是00:12:10。 </p>
<ul>
<li><p>(不推荐使用)可以使用不带有冒号的 字符串或者数字，格式为’ HHMMSS ‘或者 HHMMSS 。</p>
<p>如果插入一个不合法的字符串或者数字，MySQL在存 储数据时，会将其自动转化为00:00:00进行存储。</p>
<p>比如1210，MySQL会将最右边的两位解析成秒，表示 00:12:10，而不是12:10:00。 </p>
</li>
<li><p>使用 CURRENT_TIME() 或者 NOW() ，会插入当前系统的时间。</p>
</li>
</ul>
<h4 id="DATETIME类型"><a href="#DATETIME类型" class="headerlink" title="DATETIME类型"></a>DATETIME类型</h4><p>DATETIME类型占用 8个字节 的存储空间</p>
<p><strong>在MySQL中DATETIME的存储格式：</strong></p>
<ul>
<li><p><strong>YYYY-MM-DD HH:MM:SS</strong></p>
<p>其中YYYY表示年份，MM表示月 份，DD表示日期，HH表示小时，MM表示分钟，SS表示秒。</p>
</li>
<li><p>以 YYYY-MM-DD HH:MM:SS 格式或者 YYYYMMDDHHMMSS 格式的字符串插入DATETIME类型的字段时，</p>
<p>最小值为1000-01-01 00:00:00，最大值为9999-12-03 23:59:59。 </p>
<p><strong>隐式转换：以YYYYMMDDHHMMSS格式的数字插入DATETIME类型的字段时，会被转化为YYYY-MM-DD HH:MM:SS格式。</strong></p>
</li>
<li><p>使用 CURRENT_TIMESTAMP() 和 NOW() ，会插入系统的当前日期和 时间。</p>
</li>
</ul>
<h4 id="TIMESTAMP类型"><a href="#TIMESTAMP类型" class="headerlink" title="TIMESTAMP类型"></a>TIMESTAMP类型</h4><p>TIMESTAMP类型占用 4个字节 的存储空间，但取值范围比DATETIME类型要小，<strong>底层以毫秒数储存</strong></p>
<p><strong>在MySQL中TIMESTAMP的存储格式：</strong></p>
<ul>
<li><p><strong>YYYY-MM-DD HH:MM:SS</strong></p>
</li>
<li><p>存储数据的时候需要对当前时间所在的时区进行转换，查询数据的时候再将时间转换回当前的时区。</p>
<p>因此，使用TIMESTAMP存储的同一个时间值，在不同的时区查询时会显示不同的时间。</p>
</li>
</ul>
<p>TIMESTAMP和DATETIME的区别： </p>
<p>①TIMESTAMP存储空间比较小，表示的日期时间范围也比较小 </p>
<p>②底层存储方式不同，TIMESTAMP底层存储的是毫秒值，距离1970-1-1 0:0:0 0毫秒的毫秒值。</p>
<p>③两个日期比较大小或日期计算时，TIMESTAMP更方便、更快。 </p>
<p>④TIMESTAMP和时区有关。TIMESTAMP会根据用户的时区不同，显示不同的结果。</p>
<p>⑤DATETIME则只能 反映出插入时当地的时区，其他时区的人查看数据必然会有误差的。</p>
<p>补充：DATETIME  和 TIMESTAMP 的使用频率分析：</p>
<p>用得最多的日期时间类型，就是 DATETIME 。此外，一般存注册时间、商品发布时间等，不建议使用DATETIME存储，</p>
<p>而是使用 时间戳 ，因为 DATETIME虽然直观，但不便于计算。</p>
<p>SELECT UNIX_TIMESTAMP()；获取一个时间戳</p>
<h3 id="文本字符串类型"><a href="#文本字符串类型" class="headerlink" title="文本字符串类型"></a>文本字符串类型</h3><p><strong>MySQL中，文本字符串总体上分为 CHAR 、 VARCHAR 、 TINYTEXT 、 TEXT 、 MEDIUMTEXT 、 LONGTEXT 、 ENUM 、 SET 等类型。</strong></p>
<h4 id="CHAR-、VARCHAR类型"><a href="#CHAR-、VARCHAR类型" class="headerlink" title="CHAR 、VARCHAR类型"></a>CHAR 、VARCHAR类型</h4><table>
<thead>
<tr>
<th align="left">字符串(文本) 类型</th>
<th align="left">特点</th>
<th align="left">长度</th>
<th align="left">长度范围</th>
<th align="left">占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CHAR(M)</td>
<td align="left">固定长度</td>
<td align="left">M</td>
<td align="left">0 &lt;&#x3D; M &lt;&#x3D; 255</td>
<td align="left">M个字符</td>
</tr>
<tr>
<td align="left">VARCHAR(M)</td>
<td align="left">可变长度</td>
<td align="left">M</td>
<td align="left">0 &lt;&#x3D; M &lt;&#x3D; 65535</td>
<td align="left">(实际长度 + 1) 个字符</td>
</tr>
</tbody></table>
<p><strong>CHAR类型：</strong></p>
<ul>
<li><p>CHAR(M) 类型一般需要预先定义字符串长度。如果不指定(M)，则表示长度默认是1个字符。 </p>
</li>
<li><p>如果保存时，数据的实际长度比CHAR类型声明的长度小，则会在 右侧填充 空格以达到指定的长度。</p>
</li>
</ul>
<p>​       当MySQL检索CHAR类型的数据时，CHAR类型的字段会去除尾部的空格。 </p>
<ul>
<li>定义CHAR类型字段时，声明的字段长度即为CHAR类型字段所占的存储空间的字节数。</li>
</ul>
<p><strong>VARCHAR类型：</strong></p>
<ul>
<li><p>VARCHAR(M) 定义时， 必须指定 长度M，否则报错。 </p>
</li>
<li><p>MySQL4.0版本以下，varchar(20)：指的是20字节，如果存放UTF8汉字时，只能存6个（每个汉字3字节） ；</p>
<p>MySQL5.0版本以上，varchar(20)：指的是20字符。 </p>
</li>
<li><p>检索VARCHAR类型的字段数据时，会保留数据尾部的空格。</p>
<p>VARCHAR类型的字段所占用的存储空间 为字符串实际长度加1个字节。</p>
</li>
</ul>
<p>CHAR 和 VARCHAR的区别：</p>
<table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">特点</th>
<th align="left">空间上</th>
<th align="left">时间上</th>
<th align="left">适用场景</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CHAR(M)</td>
<td align="left">固定长度</td>
<td align="left">浪费存储空间</td>
<td align="left">效率高</td>
<td align="left">存储不大，速度要求高</td>
</tr>
<tr>
<td align="left">VARCHAR(M)</td>
<td align="left">可变长度</td>
<td align="left">节省存储空间</td>
<td align="left">效率低</td>
<td align="left">不适用于char的情况</td>
</tr>
</tbody></table>
<p>情况1：存储很短的信息。比如门牌号码101，201……这样很短的信息应该用char，因为varchar还要占个 byte用于存储信息长度，本来打算节约存储的，结果得</p>
<p>不偿失。 </p>
<p>情况2：固定长度的。比如使用uuid作为主键，那用char应该更合适。因为他固定长度，varchar动态根据 长度的特性就消失了，而且还要占个长度信息。 </p>
<p>情况3：十分频繁改变的column。因为varchar每次存储都要有额外的计算，得到长度等工作，如果一个 非常频繁改变的，那就要有很多的精力用于计算，而这些</p>
<p>对于char来说是不需要的。</p>
<h4 id="TEXT文本类型"><a href="#TEXT文本类型" class="headerlink" title="TEXT文本类型"></a>TEXT文本类型</h4><p><strong>在MySQL中，TEXT用来保存文本类型的字符串，总共包含4种类型，分别为TINYTEXT、TEXT、 MEDIUMTEXT 和 LONGTEXT 类型。</strong></p>
<table>
<thead>
<tr>
<th align="left">文本字符串类型</th>
<th align="left">特点</th>
<th align="left">长度</th>
<th align="left">长度范围</th>
<th align="left">占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td align="left">TINYTEXT</td>
<td align="left">小文本、可变长度</td>
<td align="left">L</td>
<td align="left">0 &lt;&#x3D; L &lt;&#x3D; 255</td>
<td align="left">L + 2 个字符</td>
</tr>
<tr>
<td align="left">TEXT</td>
<td align="left">文本、可变长度</td>
<td align="left">L</td>
<td align="left">0 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td align="left">L + 2 个字符</td>
</tr>
<tr>
<td align="left">MEDIUMTEXT</td>
<td align="left">中等文本、可变长度</td>
<td align="left">L</td>
<td align="left">中等文本、可变长度</td>
<td align="left">L + 3 个字符</td>
</tr>
<tr>
<td align="left">LONGTEXT</td>
<td align="left">大文本、可变长度</td>
<td align="left">L</td>
<td align="left">0 &lt;&#x3D; L&lt;&#x3D; 4294967295（相当于 4GB）</td>
<td align="left">L + 4 个字符</td>
</tr>
</tbody></table>
<ul>
<li>由于实际存储的长度不确定，MySQL 不允许 TEXT 类型的字段做主键。在这种情况下只能采用 CHAR(M)，或者 VARCHAR(M)。</li>
</ul>
<h4 id="ENUM枚举类型"><a href="#ENUM枚举类型" class="headerlink" title="ENUM枚举类型"></a>ENUM枚举类型</h4><p>ENUM类型也叫作枚举类型，必须从取值范围中添加的元素中多选一，不能一次选多个值。</p>
<table>
<thead>
<tr>
<th align="left">文本字符串类型</th>
<th align="left">长度</th>
<th align="left">长度范围</th>
<th align="left">占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ENUM</td>
<td align="left">L</td>
<td align="left">1 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td align="left">1或2个字符</td>
</tr>
</tbody></table>
<ul>
<li>当ENUM类型包含1～255个成员时，需要1个字节的存储空间； </li>
<li>当ENUM类型包含256～65535个成员时，需要2个字节的存储空间。 </li>
<li>ENUM类型的成员个数的上限为65535个。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#创建表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_enum(</span><br><span class="line">season ENUM(<span class="string">&#x27;春&#x27;</span>,<span class="string">&#x27;夏&#x27;</span>,<span class="string">&#x27;秋&#x27;</span>,<span class="string">&#x27;冬&#x27;</span>,<span class="string">&#x27;unknow&#x27;</span>)</span><br><span class="line">);</span><br><span class="line">#添加数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_enum</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;春&#x27;</span>),(<span class="string">&#x27;秋&#x27;</span>);</span><br><span class="line"># 忽略大小写</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_enum</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;UNKNOW&#x27;</span>);</span><br><span class="line"># 允许按照角标的方式获取指定索引位置的枚举值</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_enum</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;1&#x27;</span>),(<span class="number">3</span>);</span><br><span class="line"># Data truncated <span class="keyword">for</span> <span class="keyword">column</span> <span class="string">&#x27;season&#x27;</span> <span class="keyword">at</span> <span class="type">row</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_enum</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;ab&#x27;</span>);</span><br><span class="line"># 当ENUM类型的字段没有声明为<span class="keyword">NOT</span> <span class="keyword">NULL</span>时，插入<span class="keyword">NULL</span>也是有效的</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_enum</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>

<h4 id="SET类型"><a href="#SET类型" class="headerlink" title="SET类型"></a>SET类型</h4><p>可以从取值范围中添加的元素中添加多个，但取值范围中的元素越多，则占用空间越大</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhjlxP.png" alt="SET取值范围"></p>
<ul>
<li>插入重复的SET类型成员，MySQL会自动删除重复的成员</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#创建表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_set(</span><br><span class="line">s <span class="keyword">SET</span> (<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">);</span><br><span class="line">#插入数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_set (s) <span class="keyword">VALUES</span> (<span class="string">&#x27;A&#x27;</span>), (<span class="string">&#x27;A,B&#x27;</span>);</span><br><span class="line">#插入重复的<span class="keyword">SET</span>类型成员时，MySQL会自动删除重复的成员</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_set (s) <span class="keyword">VALUES</span> (<span class="string">&#x27;A,B,C,A&#x27;</span>);</span><br><span class="line">#向<span class="keyword">SET</span>类型的字段插入<span class="keyword">SET</span>成员中不存在的值时，MySQL会抛出错误。</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_set (s) <span class="keyword">VALUES</span> (<span class="string">&#x27;A,B,C,D&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> test_set;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> temp_mul(</span><br><span class="line">gender ENUM(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">hobby <span class="keyword">SET</span>(<span class="string">&#x27;早&#x27;</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;晚&#x27;</span>,<span class="string">&#x27;测试&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> temp_mul <span class="keyword">VALUES</span>(<span class="string">&#x27;早&#x27;</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;晚&#x27;</span>); #成功</span><br></pre></td></tr></table></figure>

<h3 id="二进制字符串类型"><a href="#二进制字符串类型" class="headerlink" title="二进制字符串类型"></a>二进制字符串类型</h3><p>使用频率较低，了解一下</p>
<p>MySQL中支持的二进制字符串类型主要包括BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB 和 LONGBLOB类型。</p>
<h4 id="BINARY-、VARBINARY类型"><a href="#BINARY-、VARBINARY类型" class="headerlink" title="BINARY 、VARBINARY类型"></a>BINARY 、VARBINARY类型</h4><p><strong>BINARY和VARBINARY，只是它们存储的是二进制字符串。</strong></p>
<p>BINARY 、VARBINARY类型的存储类似于CHAR和VARCHAR</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhjYVg.png" alt="二进制字符串"></p>
<h4 id="BLOB类型"><a href="#BLOB类型" class="headerlink" title="BLOB类型"></a>BLOB类型</h4><p><strong>MySQL中的BLOB类型包括TINYBLOB、BLOB、MEDIUMBLOB和LONGBLOB 4种类型，</strong></p>
<p>它们可容纳值的最大 长度不同。可以存储一个二进制的大对象，比如 图片 、 音频 和 视频 等。</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhjaPs.png" alt="BLOB类型"></p>
<p><strong>TEXT和BLOB两者都需要注意的事项：</strong></p>
<p>①在针对以BLOB和TEXT类型的字段数据进行大量的删除和更新的操作之后，在数据表上会留下很多碎片，造成数据库的”空洞“，会对数据库的检索效率造成较大</p>
<p>的影响，可以使用指令  OPTIMIZE TABLE 解决这些空洞问题</p>
<p>②对数据量很大的文本字段进行模糊查询时，MySQL 提供了 前缀索引 ，但不宜不添加任何条件的情况下检索大量的数据，无目的的检索会让数据库于I&#x2F;O的交互</p>
<p>次数增加，反而形成负优化。</p>
<p>③针对上述的第一种情况，需要对数据量大的文本数据进行操作时，可以考虑将这些数据移动到另一张数据表中，主表不会因为副表的删除、更新数据的影响产生</p>
<p>过多的数据”空洞”，有利于优化查询速度</p>
<h4 id="JSON类型"><a href="#JSON类型" class="headerlink" title="JSON类型"></a>JSON类型</h4><p>JSON 可以将 JavaScript 对象中表示的一组数据转换为字符串，然后就可以在网络或者程序之间轻 松地传递这个字符串，并在需要的时候将它还原为各编程语言所支持的数据格式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#创建json表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_json(</span><br><span class="line">js json</span><br><span class="line">);</span><br><span class="line">#想表中插入json数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_json (js)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;&#123;&quot;name&quot;:&quot;songhk&quot;, &quot;age&quot;:18, &quot;address&quot;:&#123;&quot;province&quot;:&quot;beijing&quot;,</span></span><br><span class="line"><span class="string">&quot;city&quot;:&quot;beijing&quot;&#125;&#125;&#x27;</span>);</span><br><span class="line">#查询表中的js数据</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span> test_json;</span><br><span class="line"></span><br><span class="line">#检索json类型数据的某个具体值</span><br><span class="line"><span class="keyword">SELECT</span> js <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.name&#x27;</span> <span class="keyword">AS</span> NAME,</span><br><span class="line">js <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.age&#x27;</span> <span class="keyword">AS</span> age,</span><br><span class="line">js <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.address.province&#x27;</span> <span class="keyword">AS</span> province,</span><br><span class="line">js <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.address.city&#x27;</span> <span class="keyword">AS</span> city </span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> test_json;</span><br></pre></td></tr></table></figure>

<p>通过“-&gt;”和“-&gt;&gt;”符号，从JSON字段中正确查询出了指定的JSON数据的值。</p>
<h4 id="空间类型"><a href="#空间类型" class="headerlink" title="空间类型"></a>空间类型</h4><p>使用较少，略</p>
<hr>
<h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><p>数据完整性是指数据的精确性和可靠性。</p>
<p>数据库以约束的方式对表数据进行额外的条件限制，以此确保数据的完整性，数据的完整性可以从四个方面考虑：</p>
<p>①实体完整性。如：同张表不能出现完全相同的记录</p>
<p>②域完整性。如：年龄范围0-120</p>
<p>③引用完整性。如：员工所在的部门，在部门表中一定会存在此部门</p>
<p>④用户自定义完整性。如：用户名唯一、用户名不为空。</p>
<h3 id="约束的分类"><a href="#约束的分类" class="headerlink" title="约束的分类"></a>约束的分类</h3><ol>
<li><p>约束的字段个数</p>
<p>单列约束 ：每个约束只约束一列</p>
<p>多列约束：每个约束可约束多列数据</p>
</li>
<li><p>约束的作用范围</p>
<p>列级约束：将此约束声明在对应的字段的后面</p>
<p>表级约束：在表中所有字段声明完，在所有字段后面声明的约束</p>
</li>
<li><p>约束的作用</p>
<p>①not null (非空约束)</p>
<p>②unique (唯一性约束)</p>
<p>③primary key (主键约束)</p>
<p>④foreign key (外键约束)</p>
<p>⑤check  (检查约束)</p>
<p>⑥defalut  (默认值约束)</p>
</li>
<li><p>添加约束的方式</p>
</li>
</ol>
<p>​	CREATE TABLE时添加约束</p>
<p>​	ALTER TABLE时增加约束、删除约束</p>
<ol start="5">
<li>查看表中的约束</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#information_schema数据库名（系统库）</span><br><span class="line">#table_constraints表名称（专门存储各个表的约束）</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> information_schema.table_constraints</span><br><span class="line"><span class="keyword">WHERE</span> table_name <span class="operator">=</span> <span class="string">&#x27;表名称&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束*"></a>非空约束*</h4><p>作用：限定某个字段&#x2F;列不能为空</p>
<p><strong>非空约束只能用列级约束，不能使用表级约束</strong></p>
<p>关键字：NOT NULL</p>
<ol>
<li><p>在创建表的时候添加约束</p>
<p>CREATE TABLE 表名称( </p>
<p>字段名 数据类型, </p>
<p>字段名 数据类型 NOT NULL, </p>
<p>字段名 数据类型 NOT NULL );</p>
</li>
<li><p>建表后通过MODIFY + 列级约束的方式 增加约束</p>
<p>alter table 表名称</p>
<p>modify 字段名 数据类型 not null;</p>
</li>
<li><p>删除非空约束</p>
<p>alter table 表名称</p>
<p>modify 字段名 数据类型 NULL;</p>
<p>alter table 表名称 </p>
<p>modify 字段名 数据类型;</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#在创建表的时候添加约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> table1(</span><br><span class="line">id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">25</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">email <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line">salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#建表后通过MODIFY <span class="operator">+</span> 列级约束的方式 增加约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1</span><br><span class="line">MODIFY email <span class="type">VARCHAR</span>(<span class="number">25</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#建表后通过MODIFY <span class="operator">+</span> 列级约束的方式 删除约束条件</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1</span><br><span class="line">MODIFY email <span class="type">VARCHAR</span>(<span class="number">25</span>) <span class="keyword">NULL</span>;#去掉<span class="keyword">not</span> <span class="keyword">null</span>，相当于修改某个非注解字段，该字段允许为空</span><br><span class="line"></span><br><span class="line">#建表后通过MODIFY <span class="operator">+</span> 列级约束的方式 删除约束条件</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1</span><br><span class="line">MODIFY email <span class="type">VARCHAR</span>(<span class="number">25</span>);#去掉<span class="keyword">not</span> <span class="keyword">null</span>，相当于修改某个非注解字段，该字段允许为空</span><br></pre></td></tr></table></figure>

<h4 id="唯一性约束"><a href="#唯一性约束" class="headerlink" title="唯一性约束*"></a>唯一性约束*</h4><p>作用：限定某个字段&#x2F;列不能重复</p>
<p>关键字：UNIQUE</p>
<ol>
<li><p>创建表的时候添加约束</p>
<p>①列级约束：</p>
</li>
</ol>
<p>​	create table 表名称( </p>
<p>​	字段名 数据类型, </p>
<p>​	字段名 数据类型 unique, </p>
<p>​	字段名 数据类型 ); </p>
<p>​		②表级约束：</p>
<p>​	create table 表名称( </p>
<p>​	字段名 数据类型, </p>
<p>​	字段名 数据类型, </p>
<p>​     字段名 数据类型, </p>
<p>​	[constraint 约束名] unique key(字段名));</p>
<ol start="2">
<li><p>建表后</p>
<p>①通过ADD + 表级约束的方式 增加约束</p>
<p>alter table 表名称 </p>
<p>add constraint 约束名 unique key(字段列表);</p>
<p>②通过MODIFY + 列级约束的方式 增加约束</p>
<p>alter table 表名称 </p>
<p>modify 字段名 字段类型 unique;</p>
</li>
<li><p>复合唯一性约束：</p>
<p>create table 表名称( </p>
<p>字段名 数据类型, </p>
<p>字段名 数据类型, </p>
<p>字段名 数据类型, </p>
<p>unique key(字段列表));</p>
</li>
</ol>
<p>​		<strong>表示用户名和密码组合不能重复，即表中的两个数据的用户名和密码不能完全一致</strong></p>
<ol start="4">
<li><p>删除唯一约束</p>
<p>ALTER TABLE 数据表名 </p>
<p>DROP INDEX 创建唯一约束时所起的名字;</p>
<p><strong>删除唯一约束即通过删除唯一索引，删除时指定的唯一索引名为 创建唯一约束时所起的名字</strong></p>
<p><strong>创建唯一约束时所起的名字(若是单列，默认和列名相同；若是组合列，默认是字段列表中的第一个字段的名字)</strong></p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#唯一性约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table2(</span><br><span class="line">id <span class="type">INT</span> <span class="keyword">UNIQUE</span>,#列级约束</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">email <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">#表级约束</span><br><span class="line"><span class="keyword">CONSTRAINT</span> uni_table2_email <span class="keyword">UNIQUE</span>(email)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table2(id,last_name,email,salary)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;14555@qq.com&#x27;</span>,<span class="number">1250.12</span>);</span><br><span class="line"></span><br><span class="line">#建表后通过<span class="keyword">ADD</span> <span class="operator">+</span> 表级约束的方式 增加约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table2</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> uni_table2_sal <span class="keyword">UNIQUE</span>(salary);</span><br><span class="line"></span><br><span class="line">#建表后通过MODIFY <span class="operator">+</span> 列级约束的方式 增加约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table2</span><br><span class="line">MODIFY last_name <span class="type">VARCHAR</span>(<span class="number">25</span>) <span class="keyword">UNIQUE</span>;</span><br><span class="line"></span><br><span class="line">#复合唯一性约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">USER</span>(</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line">PASSWORD <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line"></span><br><span class="line">#表级约束</span><br><span class="line"><span class="keyword">CONSTRAINT</span> uni_table2_user_name <span class="keyword">UNIQUE</span>(id,last_name)</span><br><span class="line">    #字段列表中写的是多个字段名，多个字段名用逗号分隔，表示那么是复合唯一，即多个字段的组合是唯一的 );</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#删除唯一性约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table2</span><br><span class="line"><span class="keyword">DROP</span> INDEX uni_table2_sal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table2</span><br><span class="line"><span class="keyword">DROP</span> INDEX last_name;</span><br></pre></td></tr></table></figure>

<h4 id="主键约束"><a href="#主键约束" class="headerlink" title="主键约束*"></a>主键约束*</h4><p><strong>作用：用来唯一标识表的一行记录，一个表中最多只能由一个主键约束</strong></p>
<p>主键约束相当于唯一约束 + 非空约束的组合，即不允许列重复，也不能出现空值</p>
<p>关键字：primary key</p>
<ol>
<li><p>创建表时添加主键约束</p>
<p>①表级约束：</p>
<p>create table 表名称( </p>
<p>字段名 数据类型, </p>
<p>字段名 数据类型,</p>
<p>字段名 数据类型,</p>
<p>[constraint 约束名] primary key(字段名)  );</p>
<p>②列级约束</p>
<p>create table 表名称(</p>
<p>字段名 数据类型 primary key,</p>
<p>字段名 数据类型,</p>
<p>字段名 数据类型)</p>
</li>
<li><p>建表后添加主键约束</p>
<p>①使用MODIFY + 列级约束在CREATE TABLE 之后添加主键约束<br>ALTER TABLE 表名称</p>
<p>MODIFY 字段名 数据类型 PRIMARY KEY;</p>
<p>②使用ADD + 表级约束在CREATE TABLE 之后添加主键约束</p>
<p>ALTER TABLE 表名称</p>
<p>ADD PRIMARY KEY(字段列表)</p>
</li>
<li><p>复合主键约束</p>
<p>create table 表名称( </p>
<p>字段名 数据类型, </p>
<p>字段名 数据类型, </p>
<p>字段名 数据类型, </p>
<p>primary key(字段名1,字段名2) );</p>
<p><strong>多列组合的复合主键约束，其中任何列的值都不允许为null，且不能完全一致和重复</strong></p>
</li>
<li><p>删除主键约束(不建议删除，破坏了数据的特征)</p>
<p>alter table 表名称</p>
<p>drop primary key;</p>
<p>补充：删除表的主键约束后由其影响的不能为空的性质依旧存在</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#主键约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table3(</span><br><span class="line">#id <span class="type">int</span> <span class="keyword">primary</span> key,#列级约束</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line">salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">email <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">    </span><br><span class="line">#表级约束</span><br><span class="line">#<span class="keyword">primary</span> key主键不需要起名，其名字永远都是<span class="keyword">primary</span>    </span><br><span class="line"><span class="keyword">CONSTRAINT</span> <span class="keyword">PRIMARY</span> KEY(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#复合主键约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test(</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">NAME <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">PASSWORD <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line"></span><br><span class="line"><span class="keyword">CONSTRAINT</span> <span class="keyword">PRIMARY</span> KEY(NAME,PASSWORD)#表示字段<span class="number">1</span>和字段<span class="number">2</span>的组合是唯一的，也可以有更多个字段</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#多列组合的复合主键约束，其中任何列的值都不允许为<span class="keyword">null</span>，且不能完全一致和重复</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test(id,NAME,PASSWORD)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;abc123&#x27;</span>);#不可行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#在<span class="keyword">ALTER</span> <span class="keyword">TABLE</span>中添加主键约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test1(</span><br><span class="line">#id <span class="type">int</span> <span class="keyword">primary</span> key,#列级约束</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line">salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">email <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">#表级约束</span><br><span class="line">#<span class="keyword">CONSTRAINT</span> <span class="keyword">PRIMARY</span> KEY(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#使用MODIFY <span class="operator">+</span> 列级约束在<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 之后添加主键约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test1</span><br><span class="line">MODIFY id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY;</span><br><span class="line"></span><br><span class="line">#使用<span class="keyword">ADD</span> <span class="operator">+</span> 表级约束在<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 之后添加主键约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test1</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="keyword">PRIMARY</span> KEY (id);</span><br><span class="line"></span><br><span class="line">#删除主键约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test1</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY;</span><br></pre></td></tr></table></figure>

<h4 id="自增列"><a href="#自增列" class="headerlink" title="自增列"></a>自增列</h4><p>作用：某个字段的值自增</p>
<p>关键字：AUTO_INCREMENT</p>
<p>自增列的特定和要求：</p>
<ul>
<li><strong>一个表最多只能有一个自增长列</strong></li>
<li>当需要产生唯一标识符或顺序值时，可设置自增长</li>
<li><strong>自增长列约束的列必须是键列（主键列，唯一键列）</strong></li>
<li><strong>自增约束的列的数据类型必须是整数类型</strong></li>
<li>如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接 赋值为具体值。</li>
</ul>
<ol>
<li><p>使用MODIFY + 列级约束在CREATE TABLE 之后添加自增列</p>
<p>alter table 表名称 </p>
<p>modify 字段名 数据类型 auto_increment;</p>
</li>
<li><p>删除自增约束</p>
</li>
</ol>
<p>​		alter table 表名称 </p>
<p>​		modify 字段名 数据类型; </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#创建表时添加自增列</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test2(</span><br><span class="line">id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#在一般情况下，一旦主键字段上添加了auto_increment，</span><br><span class="line">#则在添加数据时，不建议给主键对应的字段赋值</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test2(last_name)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;marry&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#在建表后添加</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test3(</span><br><span class="line">id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#使用MODIFY <span class="operator">+</span> 列级约束在<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 之后添加自增列</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test3</span><br><span class="line">MODIFY id <span class="type">INT</span> AUTO_INCREMENT;</span><br><span class="line"></span><br><span class="line">#删除自增列</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test3</span><br><span class="line">MODIFY id <span class="type">INT</span>;#去掉auto_increment相当于删除</span><br><span class="line"></span><br><span class="line">#自增列的值在<span class="number">8.0</span>中不会随着数据库的重启而变化，在<span class="number">5.7</span>中则在重启后按现有存在的最后的一个值自增</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test3</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<h4 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h4><p>不建议在数据库层面使用，可以了解一下</p>
<p>原因是：在 MySQL 里，外键约束是有成本的，因为外键约束的系统开销而变得非常慢 </p>
<p>​				而在应用层面也可以起到限制作用，来实现外键约束的功能，确保数据的一致性。</p>
<p>作用：限定某个表的字段的引用完整性 </p>
<p>关键字：FOREIGN KEY</p>
<ol>
<li><p>主表和从表</p>
<p>主表(父表)：被引用的表，被参考的表</p>
<p>从表(子表)：引用其他的表，参考其他的表</p>
</li>
<li><p>外键约束的特点：</p>
<p>①在创建外键约束时，如果不给外键约束命名，默认名不是列名，</p>
<p>​    而是自动产生一个外键名（例如 student_ibfk_1;），也可以指定外键约束名。</p>
<p>②在“从表”中指定外键约束，并且一个表可以建立多个外键约束</p>
<p>③在对主表进行增删改的操作之前要解除从表对主表的引用</p>
<p>④从表的外键列，必须引用&#x2F;参考主表的主键或唯一约束的列</p>
<h5 id="约束等级"><a href="#约束等级" class="headerlink" title="约束等级"></a>约束等级</h5></li>
</ol>
<ul>
<li><p>Cascade方式 ：对主表的update&#x2F;delete操作，会同步到从表中。</p>
</li>
<li><p>Set null方式 ：对主表的update&#x2F;delete操作，不会同步到从表中，从表中的数据被设为null</p>
</li>
<li><p>No action方式 ：如果主表被其他从表引用，则在解除引用之前不允许主表进行任何update&#x2F;delete操作。</p>
</li>
<li><p>Restrict方式 ：同no action， 都是立即检查外键约束 Set default方式，不允许任何操作在解除引用之前</p>
<p><strong>如果没有指定等级，就相当于Restrict方式</strong></p>
<p><strong>对于外键约束，最好是采用: ON UPDATE CASCADE ON DELETE RESTRICT 的方式。</strong></p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#在建表时添加外键约束</span><br><span class="line">#①先创建主表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept(</span><br><span class="line">dept_id <span class="type">INT</span> ,</span><br><span class="line">dept_name <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#②再创建从表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp(</span><br><span class="line">emp_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">emp_name <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">department_id <span class="type">INT</span>,</span><br><span class="line">#表级约束</span><br><span class="line"><span class="keyword">CONSTRAINT</span> fk_emp1_dept_id <span class="keyword">FOREIGN</span> KEY (department_id) <span class="keyword">REFERENCES</span> dept(dept_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#外键约束添加数据</span><br><span class="line">#在主表中添加部门id，主表中id不存在，从表添加数据会失败</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">10</span>,<span class="string">&#x27;Test&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#如果主表中的department_id不存在则会添加失败</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">#在试图删除主表的数据之前，需要解除从表对主表主键的引用，否则删除失败</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> dept</span><br><span class="line"><span class="keyword">WHERE</span> dept_id <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">#在试图更新主表的数据之前，需要解除从表对主表主键的引用，否则删除失败</span><br><span class="line"><span class="keyword">UPDATE</span> dept</span><br><span class="line"><span class="keyword">SET</span> dept_id <span class="operator">=</span> <span class="number">11</span></span><br><span class="line"><span class="keyword">WHERE</span> dept_id <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp1(</span><br><span class="line">emp_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">emp_name <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">department_id <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line">#在建表后通过使用<span class="keyword">ADD</span> <span class="operator">+</span> 表级约束在<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 之后添加外键约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp1</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_emp_dept_id <span class="keyword">FOREIGN</span> KEY(department_id) <span class="keyword">REFERENCES</span> dept(dept_id);</span><br><span class="line"></span><br><span class="line">#约束等级 cascase同步删除 restrict设置为<span class="keyword">null</span></span><br><span class="line"></span><br><span class="line">#删除外键约束  </span><br><span class="line">#同个表中可以声明多个外键约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp1</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_emp_dept_id;</span><br><span class="line"></span><br><span class="line">#删除外键约束对应的普通索引</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp1</span><br><span class="line"><span class="keyword">DROP</span> INDEX fk_emp_dept_id;</span><br></pre></td></tr></table></figure>

<h4 id="检查约束"><a href="#检查约束" class="headerlink" title="检查约束"></a>检查约束</h4><p>作用：检查某个字段的值是否符合xx的要求，一般指的是值的范围</p>
<p>关键字：check</p>
<p>MySQL5.7不支持check约束，而在8.0才支持</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test(</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">CHECK</span>(salary <span class="operator">&gt;</span> <span class="number">2000</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="number">2500</span>);</span><br></pre></td></tr></table></figure>

<h4 id="默认值约束"><a href="#默认值约束" class="headerlink" title="默认值约束*"></a>默认值约束*</h4><p>作用：给某个字段&#x2F;某列指定默认值，一旦设置默认值，在插入数据时，如果此字段没有显式赋值，则赋值为默认值。</p>
<p>关键字：DEFAULT</p>
<ol>
<li><p>建立表时</p>
<p>create table 表名称( </p>
<p>字段名 数据类型 primary key, </p>
<p>字段名 数据类型 unique key not null, </p>
<p>字段名 数据类型 unique key, </p>
<p>字段名 数据类型 not null default 默认值, );</p>
</li>
<li><p>在建表后添加使用MODIFY + 列级约束在CREATE TABLE 之后添加默认值约束</p>
<p>alter table 表名称 </p>
<p>modify 字段名 数据类型 default 默认值;</p>
</li>
<li><p>删除默认值约束</p>
<p>alter table 表名称 </p>
<p>modify 字段名 数据类型 default 默认值 not null;</p>
</li>
<li><p>为什么建表时，加 not null default ‘’ 或 default 0 </p>
<p>答：不想让表中出现null值。</p>
<p>带AUTO_INCREMENT约束的字段值是从1开始的吗？</p>
<p>答：不是，如果显式指定字段的值，则从此字段值开始自增</p>
<p>为什么不想要 null 的值？</p>
<p>答：不好比较。任何值与null做运算都是null；且效率较低，影响索引效果</p>
<p>每个表都可以任意选择存储引擎？</p>
<p>答：不是。外键约束（FOREIGN KEY）不能跨引擎使用。要求外键和主键需要使用一致的存储引擎</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test1(</span><br><span class="line">id <span class="type">INT</span>,</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">15</span>),</span><br><span class="line">salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">2000</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#在建表后添加使用MODIFY <span class="operator">+</span> 列级约束在<span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 之后添加默认值约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test1</span><br><span class="line">MODIFY salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="number">2500</span>;</span><br><span class="line"></span><br><span class="line">#删除约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test1</span><br><span class="line">MODIFY salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>);#删除默认值约束，也不保留非空约束</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="数据库的相关对象"><a href="#数据库的相关对象" class="headerlink" title="数据库的相关对象"></a>数据库的相关对象</h2><p><img src="https://s1.ax1x.com/2022/03/10/bhjoqO.png" alt="数据的相关对象"></p>
<hr>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>视图从本质上来说可以理解为是个已经存储起来的SELECT语句</p>
<p><strong>视图可以看做一个虚拟表，其本身是不存储任何数据的</strong></p>
<p>视图创建所涉及的表称为 <strong>基表</strong></p>
<p>针对视图进行的DML增删改的操作，也会修改对应的基表数据。反过来，对基表的操作也会影响视图的显示内容</p>
<p>视图其本身的创建和删除对基表中的数据没有影响</p>
<p>视图的优点：①简化查询，提高索引效率；②控制数据访问者的权限大小</p>
<p>视图的应用场景：小型项目的表较少不推荐使用视图，而针对大型项目，表较多数据比较复杂则可以考虑使用视图</p>
<h3 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h3><p>完整版：</p>
<p>CREATE [OR REPLACE] </p>
<p>[ALGORITHM &#x3D; {UNDEFINED | MERGE | TEMPTABLE}] </p>
<p>VIEW 视图名称 [(字段列表)] </p>
<p>AS 查询语句 </p>
<p>[WITH [CASCADED|LOCAL] CHECK OPTION]</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#单表视图</span><br><span class="line">#在不设置别名的情况下默认字段列名为视图字段名称</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_emp</span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,email </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line">#查询语句中的字段别名作为视图的字段名称</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_emp2</span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> employee_id emp_id,last_name month_sal,email ema</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line">#表名后面字段列表的个数需要与<span class="keyword">select</span>语句中的一致</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v_emp3(emp_id,month_sal,ema)</span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,email</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line">#通过视图查询基表中不存在的字段</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> emp_avg_sal(dep_id,sal)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> department_id,<span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br><span class="line"></span><br><span class="line">#多表视图</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ed_dept</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id,d.department_id</span><br><span class="line"><span class="keyword">FROM</span> emp e <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#利用视图对数据进行格式化</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ed_info</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT (e.last_name,<span class="string">&#x27;(&#x27;</span>,d.department_name,<span class="string">&#x27;)&#x27;</span>) emp_info</span><br><span class="line"><span class="keyword">FROM</span> emp e <span class="keyword">JOIN</span> dept d</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#基于视图创建视图</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> t_view </span><br><span class="line"><span class="keyword">AS</span> </span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<h3 id="查看视图"><a href="#查看视图" class="headerlink" title="查看视图"></a>查看视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#查看数据库的表和视图</span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line"></span><br><span class="line">#查看视图的结构</span><br><span class="line"><span class="keyword">DESCRIBE</span> ed_info;</span><br><span class="line"></span><br><span class="line">#查看视图的属性信息</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLE</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;ed_info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#查看视图的详细定义信息</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ed_info;</span><br></pre></td></tr></table></figure>

<h3 id="更新视图的数据"><a href="#更新视图的数据" class="headerlink" title="更新视图的数据"></a>更新视图的数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v_emp;</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,email </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br><span class="line">#一般情况下更新不会失败，</span><br><span class="line">#但是在视图相应修改不在基表中存在字段的数据则会更新失败</span><br><span class="line">#更新视图的数据也会导致基表数据的修改，反之亦然</span><br><span class="line"><span class="keyword">UPDATE</span> v_emp</span><br><span class="line"><span class="keyword">SET</span> email <span class="operator">=</span> <span class="string">&#x27;sky&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">101</span>;</span><br><span class="line"></span><br><span class="line">#修改视图</span><br><span class="line">#方式一</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> v_emp</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span>  employee_id,last_name,email,salary</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="number">7000</span>; </span><br><span class="line"></span><br><span class="line">#方式二</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> v_emp</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,email,salary</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<h3 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3><p>​	格式：DROP VIEW IF EXISTS 视图名称</p>
<ul>
<li>基于视图a、视图b建立的视图，在视图a、b删除后，视图c也会失效，除非手动修改或删除</li>
</ul>
<h3 id="视图的优缺点"><a href="#视图的优缺点" class="headerlink" title="视图的优缺点"></a>视图的优缺点</h3><p>优点：</p>
<p>①操作简单，操作人员不需要关注数据的底层结构等等</p>
<p>②减少数据冗余，其是利用基表生成的，没有实际的数据，其数据都源于基表</p>
<p>③数据安全，可以限制数据访问者的权限大小</p>
<p>④适应灵活多变的需求，</p>
<p>⑤能够分解复杂的查询逻辑，可以将复杂的查询保存下来。</p>
<p>缺点：维护成本过高，因此小项目不推荐使用，大项目则可以考虑</p>
<hr>
<h2 id="存储过程-与-存储函数"><a href="#存储过程-与-存储函数" class="headerlink" title="存储过程 与 存储函数"></a>存储过程 与 存储函数</h2><p>概念：存储过程(Stored Procedure)，将一组经过 <strong>预先编译</strong> 的 SQL语句的封装。</p>
<p>执行过程：存储过程预先存储在 MySQL 服务器上，需要执行的时候，客户端只需要向服务器端发出调用 存储过程的命令，</p>
<p>​					服务器端就可以把预先存储好的这一系列 SQL 语句全部执行。</p>
<p><strong>与视图、函数的对比：</strong></p>
<p>视图是基于基表而成虚拟表，本身以提供查询为主，增删改操作较少，而存储过程是直接操作底层数据表的SQL语句</p>
<p><strong>存储过程 与 存储函数的区别在乎存储过程没有返回值，存储函数有返回值</strong></p>
<h3 id="存储过程的创建、调用"><a href="#存储过程的创建、调用" class="headerlink" title="存储过程的创建、调用"></a>存储过程的创建、调用</h3><p>格式：</p>
<p>DELIMITER $</p>
<p>CREATE PROCEDURE 存储过程名(IN|OUT|INOUT 参数名 参数类型,…) </p>
<p>[characteristics …] </p>
<p>BEGIN 存储过程体 </p>
<p>END $</p>
<p>DELIMITER ;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">#创建存储过程</span><br><span class="line"></span><br><span class="line">#类型一：无参数无返回值</span><br><span class="line">#创建存储过程select_all_data()，查看employees表的所有数据</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> select_all_data()</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER;</span><br><span class="line">#调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> select_all_data();</span><br><span class="line"></span><br><span class="line">#类型二：带<span class="keyword">OUT</span></span><br><span class="line">#创建存储过程show_min_salary()，查看“emps”表的最低薪资值。并将最低薪资通过<span class="keyword">OUT</span>参数“ms”输出</span><br><span class="line"><span class="keyword">DESC</span> employees;</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> show_min_salary(<span class="keyword">OUT</span> ms <span class="keyword">DOUBLE</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">INTO</span> ms</span><br><span class="line">	<span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> show_min_salary(<span class="variable">@ms</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@ms</span>;</span><br><span class="line"></span><br><span class="line">#类型三：带<span class="keyword">IN</span></span><br><span class="line">#创建存储过程show_someone_salary()，查看“emps”表的某个员工的薪资，并用<span class="keyword">IN</span>参数empname输入员工姓名。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> show_someone_salary(<span class="keyword">IN</span> empname <span class="type">VARCHAR</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="operator">=</span> empname;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> show_someone_salary(<span class="string">&#x27;Abel&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#类型四：带<span class="keyword">IN</span>、<span class="keyword">OUT</span></span><br><span class="line">#创建存储过程show_someone_salary2()，查看“emps”表的某个员工的薪资，并用<span class="keyword">IN</span>参数empname</span><br><span class="line">#输入员工姓名，用<span class="keyword">OUT</span>参数empsalary输出员工薪资。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> show_someone_salary2(<span class="keyword">IN</span> empname <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">OUT</span> empsalary <span class="keyword">DOUBLE</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> empsalary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="operator">=</span> empname;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@empname</span> <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span>;</span><br><span class="line"><span class="keyword">CALL</span> show_someone_salary2(<span class="variable">@empname</span>,<span class="variable">@empsalary</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@empsalary</span>;</span><br><span class="line"></span><br><span class="line">#类型五：带 <span class="keyword">INOUT</span></span><br><span class="line">#创建存储过程show_mgr_name()，查询某个员工领导的姓名，</span><br><span class="line">#并用<span class="keyword">INOUT</span>参数“empname”输入员工姓名，输出领导的姓名。</span><br><span class="line"><span class="keyword">DESC</span> employees;</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> show_mgr_name(<span class="keyword">INOUT</span> empname <span class="type">VARCHAR</span>(<span class="number">25</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> last_name <span class="keyword">INTO</span> empname</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> (</span><br><span class="line">				<span class="keyword">SELECT</span> manager_id</span><br><span class="line">				<span class="keyword">FROM</span> employees</span><br><span class="line">				<span class="keyword">WHERE</span> last_name <span class="operator">=</span> empname</span><br><span class="line">			     );</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@empname</span> :<span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span>;</span><br><span class="line"><span class="keyword">CALL</span> show_mgr_name(<span class="variable">@empname</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@empname</span>;</span><br></pre></td></tr></table></figure>

<h3 id="储存函数的使用"><a href="#储存函数的使用" class="headerlink" title="储存函数的使用"></a>储存函数的使用</h3><p>格式：</p>
<p>CREATE FUNCTION 函数名(参数名 参数类型,…) </p>
<p>RETURNS 返回值类型 </p>
<p>[characteristics …] </p>
<p>BEGIN 函数体 #函数体中肯定有 RETURN 语句 </p>
<p>END</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>创建存储函数，名称为email_by_name()，参数定义为空，该函数查询Abel的email，并返回，数据类型为字符串型。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> email_by_name()</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">25</span>)</span><br><span class="line">	<span class="keyword">DETERMINISTIC</span></span><br><span class="line">	<span class="keyword">CONTAINS</span> <span class="keyword">SQL</span></span><br><span class="line">	<span class="keyword">READS</span> <span class="keyword">SQL</span> DATA</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">RETURN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> email</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> email_by_name();</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>创建存储函数，名称为email_by_id()，参数传入emp_id，</span><br><span class="line">#该函数查询emp_id的email，并返回，数据类型为字符串型。</span><br><span class="line"></span><br><span class="line">#创建函数前执行此语句<span class="keyword">SET</span> <span class="keyword">GLOBAL</span> log_bin_trust_function_creators <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">#可不用指明函数特性</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> email_by_id(emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">25</span>)</span><br><span class="line">	<span class="keyword">DETERMINISTIC</span> </span><br><span class="line">	<span class="keyword">CONTAINS</span> <span class="keyword">SQL</span></span><br><span class="line">	<span class="keyword">READS</span> <span class="keyword">SQL</span> DATA </span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">RETURN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> email</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id</span><br><span class="line">		);</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> email_by_id(<span class="number">102</span>);</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>创建存储函数count_by_id()，参数传入dept_id，</span><br><span class="line">#该函数查询dept_id部门的员工人数，并返回，数据类型为整型。</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> log_bin_trust_function_creators <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> count_by_id(dept_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">RETURN</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> department_id <span class="operator">=</span> dept_id</span><br><span class="line">		);</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@dept</span>_id <span class="operator">=</span> <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> count_by_id(<span class="variable">@dept</span>_id);</span><br></pre></td></tr></table></figure>

<h3 id="存储过程和存储函数的对比"><a href="#存储过程和存储函数的对比" class="headerlink" title="存储过程和存储函数的对比"></a>存储过程和存储函数的对比</h3><table>
<thead>
<tr>
<th align="left"></th>
<th align="left">关键字</th>
<th align="left">调用语法</th>
<th align="left">返回值</th>
<th align="left">应用场景</th>
</tr>
</thead>
<tbody><tr>
<td align="left">存储过程</td>
<td align="left">PROCEDURE</td>
<td align="left">CALL 存储过程()</td>
<td align="left">理解为有0个或 多个</td>
<td align="left">一般用于更新</td>
</tr>
<tr>
<td align="left">存储函数</td>
<td align="left">FUNCTION</td>
<td align="left">SELECT 函数 ()</td>
<td align="left">只能是一个</td>
<td align="left">一般用于查询结果为一个值并返回时</td>
</tr>
</tbody></table>
<ul>
<li>存储函数可以放在查询语句中使用，存储过程不行。</li>
<li>但存储过程的功能比存储函数强大</li>
</ul>
<h3 id="存储过程与存储函数的查看、修改、删除"><a href="#存储过程与存储函数的查看、修改、删除" class="headerlink" title="存储过程与存储函数的查看、修改、删除"></a>存储过程与存储函数的查看、修改、删除</h3><ol>
<li><p>查看</p>
<p><strong>①SHOW CREATE  {PROCEDURE | FUNCTION} 存储过程名或函数名</strong></p>
<p>②SHOW  {PROCEDURE | FUNCTION}  STATUS [LIKE ‘pattern’]</p>
</li>
</ol>
<p>​	   ③SELECT * FROM   information_schema.Routines </p>
<p>​           WHERE   ROUTINE_NAME&#x3D;’存储过程或函数的名’</p>
<p>​           [AND ROUTINE_TYPE  &#x3D;  {‘PROCEDURE|FUNCTION’}];</p>
<ol start="2">
<li><p>修改</p>
<p>修改的只是函数的特性，不能修改存储过程或者存储功能，</p>
<p>使用ALTER语句characteristic指定存储过程或函数的特性，</p>
<p><strong>ALTER {PROCEDURE | FUNCTION} 存储过程或函数的名 [characteristic …]</strong></p>
</li>
<li><p>删除</p>
<p><strong>DROP {PROCEDURE | FUNCTION} [IF EXISTS] 存储过程或函数的名称</strong></p>
</li>
</ol>
<h3 id="存储过程的优缺点"><a href="#存储过程的优缺点" class="headerlink" title="存储过程的优缺点"></a>存储过程的优缺点</h3><p>优点：</p>
<p>①存储过程可以一次编译多次使用</p>
<p>②可以减少开发工作量</p>
<p>③存储过程的安全性强</p>
<p>④可以减少网络传输量。</p>
<p>⑤可以减少网络传输量。</p>
<p>缺点：</p>
<p>①可移植性差</p>
<p>②调试困难</p>
<p>③存储过程的版本管理很困难。</p>
<p>④它不适合高并发的场景</p>
<hr>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p><strong>在MySQL中，变量分为 系统变量 和 用户自定义变量</strong></p>
<h3 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h3><p><strong>系统变量又分为 全局(global)系统变量 和 会话系统变量(session)<strong>，</strong>以@@开头</strong></p>
<p> 全局系统变量：其软件内置的变量（俗称写死在代码中的）和配置文件中的变量。</p>
<p>会话系统变量：大部分来自于全局变量的复制，当连接断开时这些会话变量全部消失，重新连接时会从全局变量中重新复制一份。</p>
<p>针对系统变量没有显式指定，则默认为会话系统变量</p>
<ol>
<li><p>查看系统变量</p>
<ul>
<li><p>查看所有全局变量 </p>
<p>SHOW GLOBAL VARIABLES; </p>
</li>
<li><p>查看所有会话变量 </p>
<p>SHOW SESSION VARIABLES; 或 SHOW VARIABLES; </p>
</li>
<li><p>查看满足条件的部分系统变量。 </p>
<p>SHOW GLOBAL VARIABLES LIKE ‘%标识符%’; </p>
</li>
<li><p>查看满足条件的部分会话变量 </p>
<p>SHOW SESSION VARIABLES LIKE ‘%标识符%’;</p>
</li>
</ul>
</li>
<li><p>查看指定系统变量</p>
<ul>
<li><p>查看指定的系统变量的值 </p>
<p>SELECT @@global.变量名; </p>
</li>
<li><p>查看指定的会话变量的值 </p>
<p>SELECT @@session.变量名; </p>
<p>SELECT @@变量名    <strong>此方式是默认先在会话系统变量中查找，找不到才到全局系统变量中查找</strong></p>
</li>
</ul>
</li>
<li><p>修改系统变量的值</p>
</li>
</ol>
<p>​		①全局系统变量	</p>
<p>​		SET @@global.变量名&#x3D;变量值;</p>
<p>​		SET GLOBAL 变量名&#x3D;变量值;</p>
<p>​		<strong>针对当前的数据库是有效，一旦数据库重启就失效了</strong></p>
<p>​		②会话系统变量</p>
<p>​		SET @@session.变量名&#x3D;变量值;</p>
<p>​		SET SESSION 变量名&#x3D;变量值;</p>
<p>​		<strong>针对当前会话是有效的，一旦结束会话，重新建立新的会话也就失效了</strong></p>
<h3 id="用户变量"><a href="#用户变量" class="headerlink" title="用户变量"></a>用户变量</h3><p>用户变量又分为 <strong>会话用户变量</strong> 和 <strong>局部变量</strong></p>
<ul>
<li><p>会话用户变量：作用域和会话变量一样，只对 <strong>当前连接</strong> 会话有效。 </p>
</li>
<li><p>局部变量：只在 BEGIN 和 END 语句块中有效。局部变量只能在 <strong>存储过程和函数</strong> 中使用。</p>
</li>
</ul>
<ol>
<li>会话用户变量的定义</li>
</ol>
<p>​		SET @用户变量 &#x3D; 值; </p>
<p>​		SET @用户变量 :&#x3D; 值; </p>
<p>​		SELECT @用户变量 :&#x3D; 表达式 [FROM 等子句];</p>
<p>​		SELECT 表达式 INTO @用户变量 [FROM 等子句];</p>
<ol start="2">
<li><p>查看会话用户变量的值</p>
<p>SELECT @用户变量名</p>
</li>
<li><p>局部变量：</p>
</li>
</ol>
<p>​		①**局部变量必须使用declare声明 **</p>
<p>​		②<strong>声明并使用在begin….end 中（使用在存储过程和存储函数里面）</strong></p>
<p>​		③<strong>declare的方式声明的局部变量必须声明在begin的首行位置</strong></p>
<p>​		格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">#声明局部变量</span><br><span class="line"><span class="keyword">DECLARE</span> 变量名<span class="number">1</span> 变量数据类型 [<span class="keyword">DEFAULT</span> 变量默认值];# 如果没有<span class="keyword">DEFAULT</span>子句，初始值为<span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">DECLARE</span> 变量名<span class="number">2</span>,变量名<span class="number">3</span>,... 变量数据类型 [<span class="keyword">DEFAULT</span> 变量默认值];</span><br><span class="line"></span><br><span class="line">#为局部变量赋值</span><br><span class="line"><span class="keyword">SET</span> 变量名<span class="number">1</span> <span class="operator">=</span> 值;</span><br><span class="line"><span class="keyword">SELECT</span> 值 <span class="keyword">INTO</span> 变量名<span class="number">2</span> [<span class="keyword">FROM</span> 子句];</span><br><span class="line"></span><br><span class="line">#查看局部变量的值</span><br><span class="line"><span class="keyword">SELECT</span> 变量<span class="number">1</span>,变量<span class="number">2</span>,变量<span class="number">3</span>;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>会话用户变量 和 局部变量的区别</p>
<table>
<thead>
<tr>
<th></th>
<th>作用域</th>
<th>定义位置</th>
<th>语法</th>
</tr>
</thead>
<tbody><tr>
<td>会话用户变量</td>
<td>当前会话</td>
<td>会话的任何地方</td>
<td>加@符号，不用指定类型</td>
</tr>
<tr>
<td>局部变量</td>
<td>定义它的BEGIN END中</td>
<td>BEGIN END的第一句话</td>
<td>一般不用加@,需要指定类型</td>
</tr>
</tbody></table>
<hr>
</li>
</ol>
<h2 id="定义条件与处理程序"><a href="#定义条件与处理程序" class="headerlink" title="定义条件与处理程序"></a>定义条件与处理程序</h2><p>   定义条件 是事先定义程序执行过程中可能遇到的问题， </p>
<p>   处理程序 定义了在遇到问题时应当采取的处理方 式，并且保证存储过程或函数在遇到警告或错误时能继续执行。 </p>
<ul>
<li>说明：定义条件和处理程序在存储过程、存储函数中都是支持的。</li>
</ul>
<h3 id="定义条件"><a href="#定义条件" class="headerlink" title="定义条件"></a>定义条件</h3><p>定义条件即给MySQL中的错误码命名，将一个 <strong>错误名字</strong> 和 指定的 <strong>错误条件</strong> 关联起来</p>
<p>这样就能在处理程序的 DECLARE HANDLER 语句中使用。</p>
<p>错误码的说明：<strong>MySQL_error_code</strong> 和 **sqlstate_value **都可以表示MySQL的错误。 </p>
<p>MySQL_error_code是数值类型错误代码。 sqlstate_value是长度为5的字符串类型错误代码。 </p>
<p>例如，在ERROR 1418 (HY000)中，1418是MySQL_error_code，’HY000’是sqlstate_value。</p>
<p>格式：</p>
<p><strong>DECLARE 错误名称 CONDITION FOR 错误码（或错误条件）</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#定义&quot;ERROR 1148(42000)&quot;错误，名称为command_not_allowed。</span><br><span class="line"><span class="keyword">DECLARE</span> command_not_allowed <span class="keyword">CONDITION</span> <span class="keyword">FOR</span> <span class="number">1148</span>;#</span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span> command_not_allowed <span class="keyword">CONDITION</span> <span class="keyword">FOR</span> <span class="keyword">SQLSTATE</span> <span class="string">&#x27;42000&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="处理程序"><a href="#处理程序" class="headerlink" title="处理程序"></a>处理程序</h3><p>处理程序可以为SQL执行过程中发生的某种类型的错误进行特点的处理</p>
<p>格式：</p>
<p><strong>DECLARE 处理方式 HANDLER FOR 错误类型 处理语句</strong></p>
<ul>
<li>处理语句必须在sql语句执行之前声明</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/03/10/bhv9eS.png" alt="处理方式与类型"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#方法<span class="number">1</span>：捕获sqlstate_value</span><br><span class="line"><span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">SQLSTATE</span> <span class="string">&#x27;42S02&#x27;</span> <span class="keyword">SET</span> <span class="variable">@info</span> <span class="operator">=</span> <span class="string">&#x27;NO_SUCH_TABLE&#x27;</span>;</span><br><span class="line">#方法<span class="number">2</span>：捕获mysql_error_value</span><br><span class="line"><span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="number">1146</span> <span class="keyword">SET</span> <span class="variable">@info</span> <span class="operator">=</span> <span class="string">&#x27;NO_SUCH_TABLE&#x27;</span>;</span><br><span class="line">#方法<span class="number">3</span>：先定义条件，再调用</span><br><span class="line"><span class="keyword">DECLARE</span> no_such_table <span class="keyword">CONDITION</span> <span class="keyword">FOR</span> <span class="number">1146</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> NO_SUCH_TABLE <span class="keyword">SET</span> <span class="variable">@info</span> <span class="operator">=</span> <span class="string">&#x27;NO_SUCH_TABLE&#x27;</span>;</span><br><span class="line">#方法<span class="number">4</span>：使用<span class="keyword">SQLWARNING</span></span><br><span class="line"><span class="keyword">DECLARE</span> EXIT HANDLER <span class="keyword">FOR</span> <span class="keyword">SQLWARNING</span> <span class="keyword">SET</span> <span class="variable">@info</span> <span class="operator">=</span> <span class="string">&#x27;ERROR&#x27;</span>;</span><br><span class="line">#方法<span class="number">5</span>：使用<span class="keyword">NOT</span> FOUND</span><br><span class="line"><span class="keyword">DECLARE</span> EXIT HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND <span class="keyword">SET</span> <span class="variable">@info</span> <span class="operator">=</span> <span class="string">&#x27;NO_SUCH_TABLE&#x27;</span>;</span><br><span class="line">#方法<span class="number">6</span>：使用<span class="keyword">SQLEXCEPTION</span></span><br><span class="line"><span class="keyword">DECLARE</span> EXIT HANDLER <span class="keyword">FOR</span> <span class="keyword">SQLEXCEPTION</span> <span class="keyword">SET</span> <span class="variable">@info</span> <span class="operator">=</span> <span class="string">&#x27;ERROR&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><h3 id="IF结构"><a href="#IF结构" class="headerlink" title="IF结构"></a>IF结构</h3><ul>
<li>IF语句的语法结构：</li>
</ul>
<p>​		IF 表达式1 THEN 操作1 </p>
<p>​		[ELSEIF 表达式2 THEN 操作2]……</p>
<p>​		[ELSE 操作N] </p>
<p>​		END IF</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">#声明存储过程“update_salary_by_eid1”，定义<span class="keyword">IN</span>参数emp_id，输入员工编号。判断该员工</span><br><span class="line">#薪资如果低于<span class="number">8000</span>元并且入职时间超过<span class="number">5</span>年，就涨薪<span class="number">500</span>元；否则就不变。</span><br><span class="line">#if二选一</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> update_salary_by_eid1(<span class="keyword">IN</span> emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span>	</span><br><span class="line">	#声明局部变量	</span><br><span class="line">	<span class="keyword">DECLARE</span> sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的工资</span><br><span class="line">	<span class="keyword">DECLARE</span> work_year <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工工作时间</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">SELECT</span> DATEDIFF(CURDATE(),hire_date) <span class="operator">/</span> <span class="number">365</span> <span class="keyword">INTO</span> work_year </span><br><span class="line">	<span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	IF </span><br><span class="line">	sal <span class="operator">&lt;</span> <span class="number">8000</span> <span class="keyword">AND</span> work_year <span class="operator">&gt;=</span> <span class="number">5</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp</span><br><span class="line">	<span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">500</span> </span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> update_salary_by_eid1(<span class="number">104</span>);</span><br><span class="line"></span><br><span class="line">#声明存储过程“update_salary_by_eid2”，定义<span class="keyword">IN</span>参数emp_id，输入员工编号。判断该员工</span><br><span class="line">#薪资如果低于<span class="number">9000</span>元并且入职时间超过<span class="number">5</span>年，就涨薪<span class="number">500</span>元；否则就涨薪<span class="number">100</span>元。</span><br><span class="line">#if多选一</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pdate_salary_by_eid2(<span class="keyword">IN</span> emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span>	</span><br><span class="line">	#声明局部变量	</span><br><span class="line">	<span class="keyword">DECLARE</span> sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的工资</span><br><span class="line">	<span class="keyword">DECLARE</span> work_year <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工工作时间</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">SELECT</span> DATEDIFF(CURDATE(),hire_date) <span class="operator">/</span> <span class="number">365</span> <span class="keyword">INTO</span> work_year </span><br><span class="line">	<span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	IF </span><br><span class="line">	sal <span class="operator">&lt;</span> <span class="number">9000</span> <span class="keyword">AND</span> work_year <span class="operator">&gt;=</span> <span class="number">5</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp</span><br><span class="line">	<span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">500</span> </span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">UPDATE</span> emp</span><br><span class="line">	<span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">100</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> pdate_salary_by_eid2(<span class="number">103</span>);</span><br><span class="line"><span class="keyword">CALL</span> pdate_salary_by_eid2(<span class="number">104</span>);</span><br><span class="line"></span><br><span class="line">#声明存储过程“update_salary_by_eid3”，定义<span class="keyword">IN</span>参数emp_id，输入员工编号。判断该员工</span><br><span class="line">#薪资如果低于<span class="number">9000</span>元，就更新薪资为<span class="number">9000</span>元；薪资如果大于等于<span class="number">9000</span>元且低于<span class="number">10000</span>的，但是奖金</span><br><span class="line">#比例为<span class="keyword">NULL</span>的，就更新奖金比例为<span class="number">0.01</span>；其他的涨薪<span class="number">100</span>元</span><br><span class="line">#if的n选一</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> update_salary_by_eid3(<span class="keyword">IN</span> emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span>	</span><br><span class="line">	#声明局部变量	</span><br><span class="line">	<span class="keyword">DECLARE</span> sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的工资</span><br><span class="line">	<span class="keyword">DECLARE</span> bonus <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的奖金比例</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">SELECT</span> commission_pct <span class="keyword">INTO</span> bonus </span><br><span class="line">	<span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	IF </span><br><span class="line">	sal <span class="operator">&lt;</span> <span class="number">9000</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp</span><br><span class="line">	<span class="keyword">SET</span> salary <span class="operator">=</span> <span class="number">9000</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	ELSEIF sal <span class="operator">&lt;</span><span class="number">10000</span> <span class="keyword">AND</span> sal <span class="operator">&gt;=</span> <span class="number">9000</span> <span class="keyword">AND</span> bonus <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp</span><br><span class="line">	<span class="keyword">SET</span> commission_pct <span class="operator">=</span> <span class="number">0.01</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">UPDATE</span> emp</span><br><span class="line">	<span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">100</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;	</span><br><span class="line">	<span class="keyword">END</span> IF;	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> update_salary_by_eid3(<span class="number">104</span>);</span><br></pre></td></tr></table></figure>

<h3 id="CASE结构"><a href="#CASE结构" class="headerlink" title="CASE结构"></a>CASE结构</h3><ul>
<li>CASE语句的语法结构1：</li>
</ul>
<p>\情况一：类似于switch </p>
<p>CASE 表达式 WHEN 值1 THEN 结果1或语句1(如果是语句，需要加分号)</p>
<p>WHEN 值2 THEN 结果2或语句2(如果是语句，需要加分号) </p>
<p>… </p>
<p>ELSE 结果n或语句n(如果是语句，需要加分号) </p>
<p>END [case]（如果是放在begin end中需要加上case，如果放在select后面不需要） </p>
<ul>
<li>CASE语句的语法结构2：</li>
</ul>
<p>情况二：类似于多重if </p>
<p>CASE WHEN 条件1 THEN 结果1或语句1(如果是语句，需要加分号)</p>
<p> WHEN 条件2 THEN 结果2或语句2(如果是语句，需要加分号)</p>
<p>… </p>
<p>ELSE 结果n或语句n(如果是语句，需要加分号) </p>
<p>END [case]（如果是放在begin end中需要加上case，如果放在select后面不需要）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">#声明存储过程“update_salary_by_eid4”，定义<span class="keyword">IN</span>参数emp_id，输入员工编号。判断该员工</span><br><span class="line">#薪资如果低于<span class="number">9000</span>元，就更新薪资为<span class="number">9000</span>元；薪资大于等于<span class="number">9000</span>元且低于<span class="number">10000</span>的，但是奖金比例</span><br><span class="line">#为<span class="keyword">NULL</span>的，就更新奖金比例为<span class="number">0.01</span>；其他的涨薪<span class="number">100</span>元。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> update_salary_by_eid4(<span class="keyword">IN</span> emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的工资</span><br><span class="line">	<span class="keyword">DECLARE</span> bonus <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的奖金比例</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">SELECT</span> commission_pct <span class="keyword">INTO</span> bonus <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">CASE</span> </span><br><span class="line">	<span class="keyword">WHEN</span> sal <span class="operator">&lt;</span> <span class="number">9000</span> </span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> <span class="number">9000</span> </span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">WHEN</span> sal <span class="operator">&lt;</span> <span class="number">10000</span> <span class="keyword">AND</span> bonus <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> commission_pct  <span class="operator">=</span> <span class="number">0.01</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">100</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> update_salary_by_eid4(<span class="number">103</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">103</span>;</span><br><span class="line"></span><br><span class="line">#举例<span class="number">4</span>：声明存储过程update_salary_by_eid5，定义<span class="keyword">IN</span>参数emp_id，输入员工编号。判断该员工的</span><br><span class="line">#入职年限，如果是<span class="number">0</span>年，薪资涨<span class="number">50</span>；如果是<span class="number">1</span>年，薪资涨<span class="number">100</span>；如果是<span class="number">2</span>年，薪资涨<span class="number">200</span>；如果是<span class="number">3</span>年，</span><br><span class="line">#薪资涨<span class="number">300</span>；如果是<span class="number">4</span>年，薪资涨<span class="number">400</span>；其他的涨薪<span class="number">500</span>。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> update_salary_by_eid5(<span class="keyword">IN</span> emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> work_year <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录员工的工作时间</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> ROUND(DATEDIFF(CURDATE(),hire_date) <span class="operator">/</span> <span class="number">365</span>) <span class="keyword">INTO</span> work_year </span><br><span class="line">	<span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">CASE</span> work_year</span><br><span class="line">	<span class="keyword">WHEN</span> work_year <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">50</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">WHEN</span> work_year <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">100</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">WHEN</span> work_year <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">200</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">WHEN</span> work_year <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">300</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">WHEN</span> work_year <span class="operator">=</span> <span class="number">4</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">400</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">UPDATE</span> emp </span><br><span class="line">	<span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">500</span></span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> emp_id;</span><br><span class="line">	<span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> update_salary_by_eid5(<span class="number">101</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">101</span>;</span><br></pre></td></tr></table></figure>

<h2 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h2><h3 id="LOOP结构"><a href="#LOOP结构" class="headerlink" title="LOOP结构"></a>LOOP结构</h3><p>LOOP循环语句用来重复执行某些语句。LOOP内的语句一直重复执行直到循环被退出（使用LEAVE语句），跳出循环过程。</p>
<p>格式：loop_label表示LOOP语句的标注名称，可以选择省略</p>
<p>[ loop_label: ] LOOP</p>
<p>​			循环执行的语句</p>
<p>END LOOP[ loop_label  ]；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#当市场环境变好时，公司为了奖励大家，决定给大家涨工资。</span><br><span class="line">#声明存储过程“update_salary_loop()”，声明<span class="keyword">OUT</span>参数num，输出循环次数。</span><br><span class="line">#存储过程中实现循环给大家涨薪，薪资涨为原来的<span class="number">1.1</span>倍。</span><br><span class="line">#直到全公司的平均薪资达到<span class="number">12000</span>结束。并统计循环次数。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> update_salary_loop(<span class="keyword">OUT</span> num <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	#定义局部变量 </span><br><span class="line">	<span class="keyword">DECLARE</span> n <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#记录循环的次数</span><br><span class="line">	#<span class="keyword">declare</span> avg_sal <span class="keyword">double</span> <span class="keyword">default</span> <span class="number">0.0</span>;	</span><br><span class="line">	loop_label:LOOP</span><br><span class="line">	   IF (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> emp) <span class="operator">&gt;=</span> <span class="number">12000</span>  </span><br><span class="line">		<span class="keyword">THEN</span> LEAVE loop_label;</span><br><span class="line">	   <span class="keyword">END</span> IF;	    </span><br><span class="line">	   <span class="keyword">UPDATE</span> emp <span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">*</span> <span class="number">1.1</span>;  	    </span><br><span class="line">	   <span class="keyword">SET</span> n <span class="operator">=</span> n <span class="operator">+</span> <span class="number">1</span>;    </span><br><span class="line">	   <span class="keyword">END</span> LOOP loop_label;	   </span><br><span class="line">	   <span class="keyword">SET</span> num <span class="operator">=</span> n;	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="WHILE结构"><a href="#WHILE结构" class="headerlink" title="WHILE结构"></a>WHILE结构</h3><p><strong>WHILE 类似于Java中的while一样</strong></p>
<p>WHILE语句创建一个带条件判断的循环过程。</p>
<p>WHILE在执行语句执行时，会对指定的表达式进行判断，<strong>循环体被执行到直至循环条件为假 就会退出循环</strong></p>
<p>格式： while_label 表示WHILE语句的标注名称，可以选择省略,</p>
<p>[ while_label :] WHILE 循环条件 DO</p>
<p>​			循环体</p>
<p>END WHILE [ while_label] </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#市场环境不好时，公司为了渡过难关，决定暂时降低大家的薪资。</span><br><span class="line">#声明存储过程“update_salary_while()”，声明<span class="keyword">OUT</span>参数num，输出循环次数。</span><br><span class="line">#存储过程中实现循环给大家降薪，薪资降</span><br><span class="line">#为原来的<span class="number">90</span><span class="operator">%</span>。直到全公司的平均薪资达到<span class="number">5000</span>结束。并统计循环次数。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> leave_while(<span class="keyword">OUT</span> num <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">DECLARE</span> n <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#记录循环的次数</span><br><span class="line">	</span><br><span class="line">	while_label:WHILE </span><br><span class="line">	</span><br><span class="line">	 (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> emp )  <span class="operator">&gt;</span> <span class="number">5000</span> </span><br><span class="line">	 	</span><br><span class="line">	DO <span class="keyword">UPDATE</span> emp <span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">*</span> <span class="number">0.9</span>;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">SET</span> n <span class="operator">=</span> n <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">END</span> WHILE while_label;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> num <span class="operator">=</span> n;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> leave_while(<span class="variable">@num</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@num</span>;</span><br></pre></td></tr></table></figure>

<h3 id="REPEAT结构"><a href="#REPEAT结构" class="headerlink" title="REPEAT结构"></a>REPEAT结构</h3><p><strong>REPEAT类似于Java中do - while，不管结果如何首先执行一次</strong></p>
<p>REPEAT语句创建一个带条件判断的循环过程。</p>
<p>REPEAT 循环首先会执行一次循环，然后在 UNTIL 中进行表达式的判断，</p>
<p><strong>循环体内的语句会被重复，直至 循环条件为真就退出。</strong></p>
<p>格式：repeat_label为REPEAT语句的标注名称，该参数可以省略；</p>
<p>[ repeat_label : ] REPEAT</p>
<p>​				循环体</p>
<p>UNTIL 结束循环的条件表达式</p>
<p>END REPEAT [ repeat_label ]</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#当市场环境变好时，公司为了奖励大家，决定给大家涨工资。</span><br><span class="line">#声明存储过程“update_salary_repeat()”，声明<span class="keyword">OUT</span>参数num，输出循环次数。</span><br><span class="line">#存储过程中实现循环给大家涨薪，薪资涨为原来的<span class="number">1.15</span>倍。</span><br><span class="line">#直到全公司的平均薪资达到<span class="number">13000</span>结束。并统计循环次数。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> update_salary_repeat(<span class="keyword">OUT</span> num <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">DECLARE</span> cout <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#记录循环的次数</span><br><span class="line">	repeat_label:REPEAT </span><br><span class="line">		<span class="keyword">UPDATE</span> emp <span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">*</span> <span class="number">1.15</span>;</span><br><span class="line">		<span class="keyword">SET</span> cout <span class="operator">=</span> cout <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">	UNTIL (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> emp) <span class="operator">&gt;=</span> <span class="number">13000</span>#此处不可加“;结束分号”，否则报错</span><br><span class="line">	<span class="keyword">END</span> REPEAT repeat_label;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> num <span class="operator">=</span> cout;	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> update_salary_repeat(<span class="variable">@num</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@num</span>;</span><br></pre></td></tr></table></figure>

<h3 id="前三种循环的异同"><a href="#前三种循环的异同" class="headerlink" title="前三种循环的异同"></a>前三种循环的异同</h3><ol>
<li><p>三种循环都可以省略名称，<strong>但在循环中添加了循环控制条件(如LEVE 或 ITERATE)则必须要添加名称</strong></p>
</li>
<li><p>LOOP：一般先用于简单的“死循环”，通常需要配合LEAVE使用</p>
<p>WHILE：先判断后运行</p>
<p>REPEAT：先执行后判断，必定先执行一次。</p>
<p>WHILE 和 REPEAT的区别类似于Java中的while和do - while的循环区别</p>
</li>
</ol>
<h3 id="LEVEL的使用"><a href="#LEVEL的使用" class="headerlink" title="LEVEL的使用"></a>LEVEL的使用</h3><p>类似与java中的break，结束循环</p>
<p> 格式：<strong>LEAVE 标记名</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#：创建存储过程 “leave_begin()”，声明<span class="type">INT</span>类型的<span class="keyword">IN</span>参数num。给BEGIN...END加标记名，并在</span><br><span class="line">#BEGIN...END中使用IF语句判断num参数的值。</span><br><span class="line">#如果num<span class="operator">&lt;=</span><span class="number">0</span>，则使用LEAVE语句退出BEGIN...END；</span><br><span class="line">#如果num<span class="operator">=</span><span class="number">1</span>，则查询“employees”表的平均薪资；</span><br><span class="line">#如果num<span class="operator">=</span><span class="number">2</span>，则查询“employees”表的最低薪资；</span><br><span class="line">#如果num<span class="operator">&gt;</span><span class="number">2</span>，则查询“employees”表的最高薪资。</span><br><span class="line">#IF语句结束后查询“employees”表的总人数。</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> leave_begin(<span class="keyword">IN</span> num <span class="type">INT</span>)</span><br><span class="line">if_label:<span class="keyword">BEGIN</span>	</span><br><span class="line">	IF </span><br><span class="line">	num <span class="operator">&lt;=</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">THEN</span> LEAVE if_label;</span><br><span class="line">	ELSEIF num <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> emp;</span><br><span class="line">	ELSEIF num <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">FROM</span> emp;</span><br><span class="line">	ELSEIF num <span class="operator">&gt;</span> <span class="number">2</span></span><br><span class="line">	<span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> emp;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(employee_id) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> leave_begin(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">#当市场环境不好时，公司为了渡过难关，决定暂时降低大家的薪资。</span><br><span class="line">#声明存储过程“leave_while()”，声明<span class="keyword">OUT</span>参数num，输出循环次数，存储过程中使用WHILE循环给大家降低薪资为原来薪资的<span class="number">90</span><span class="operator">%</span>，</span><br><span class="line">#直到全公司的平均薪资小于等于<span class="number">10000</span>，并统计循环次数。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> leave_while(<span class="keyword">OUT</span> num <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">DECLARE</span> n <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">	while_lab:WHILE <span class="literal">TRUE</span> DO</span><br><span class="line">		IF (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> emp) <span class="operator">&lt;=</span> <span class="number">10000</span> <span class="keyword">THEN</span> LEAVE while_lab;</span><br><span class="line">		<span class="keyword">END</span> IF;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">UPDATE</span> emp <span class="keyword">SET</span> salary  <span class="operator">=</span> salary <span class="operator">*</span> <span class="number">0.9</span>;</span><br><span class="line">		<span class="keyword">SET</span> n <span class="operator">=</span> n <span class="operator">+</span> <span class="number">1</span>;	</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">END</span> WHILE while_lab;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> num <span class="operator">=</span> n;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> leave_while(<span class="variable">@num</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@num</span>;</span><br></pre></td></tr></table></figure>

<h3 id="ITERATE的使用"><a href="#ITERATE的使用" class="headerlink" title="ITERATE的使用"></a>ITERATE的使用</h3><p>类似与java中的continue，跳过本次循环</p>
<p>格式：<strong>ITERATE label</strong></p>
<ul>
<li>label参数表示循环的标志。ITERATE语句必须跟在循环标志前面。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#当n <span class="operator">&lt;</span> <span class="number">10</span> 跳出此次循环； n <span class="operator">&gt;</span> <span class="number">15</span> 结束循环 </span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> iterate_test()</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">DECLARE</span> n <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#记录循环的次数</span><br><span class="line">	</span><br><span class="line">	iterate_lab:LOOP</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> n <span class="operator">=</span> n <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	IF n <span class="operator">&lt;</span> <span class="number">10</span></span><br><span class="line">	<span class="keyword">THEN</span> ITERATE iterate_lab;</span><br><span class="line">	ELSEIF n <span class="operator">&gt;</span> <span class="number">15</span></span><br><span class="line">	<span class="keyword">THEN</span> LEAVE iterate_lab;</span><br><span class="line">	<span class="keyword">END</span> IF; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="string">&#x27;这是个测试语句&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">END</span> LOOP;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line">#共输出了<span class="number">6</span>次<span class="keyword">select</span>的语句</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h2><p> 游标提供了一种灵活的操作方式，能够对结果集中的每一条记录进行定位，并对指向的记录中的数据进行操作。</p>
<p>游标充当了 <strong>指针</strong>的作用 ，可以通过操作游标来对数据行进行操作。</p>
<h3 id="使用游标的步骤"><a href="#使用游标的步骤" class="headerlink" title="使用游标的步骤"></a>使用游标的步骤</h3><ol>
<li>声明游标</li>
</ol>
<p>​		语法格式：DECLARE 游标名 CURSOR FOR 具体的查询语句;</p>
<ol start="2">
<li>打开游标</li>
</ol>
<p>​		语法格式：OPEN 游标名</p>
<ol start="3">
<li>使用游标</li>
</ol>
<p>​		语法格式：FETCH 游标名 INTO var_name [, var_name] …</p>
<ul>
<li><strong>游标的查询结果集中的字段数，必须跟上方表中查询返回的字段数一致</strong></li>
</ul>
<ol start="4">
<li>关闭游标</li>
</ol>
<p>​		语法格式：CLOSE 游标名</p>
<ul>
<li><p>游标会占用系统资源，因此必须关闭，否则会保持到存储过程结束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#创建存储过程“get_count_by_limit_total_salary()”，声明<span class="keyword">IN</span>参数 limit_total_salary，<span class="keyword">DOUBLE</span>类型；</span><br><span class="line">#声明<span class="keyword">OUT</span>参数total_count，<span class="type">INT</span>类型。函数的功能可以实现累加薪资最高的几个员工的薪资值，</span><br><span class="line">#直到薪资总和达到limit_total_salary参数的值，返回累加的人数给total_count。</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_count_by_limit_total_salary(<span class="keyword">IN</span> limit_total_salary <span class="keyword">DOUBLE</span>,<span class="keyword">OUT</span> total_count <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	#定义局部变量</span><br><span class="line">	<span class="keyword">DECLARE</span> n <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#记录累加的次数</span><br><span class="line">	<span class="keyword">DECLARE</span> emp_sal <span class="keyword">DOUBLE</span>;#记录某一个员工的工资</span><br><span class="line">	<span class="keyword">DECLARE</span> sum_sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;#记录累加的工资总和</span><br><span class="line">	</span><br><span class="line">	#定义游标</span><br><span class="line">	<span class="keyword">DECLARE</span> emp_cursor <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> salary <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br><span class="line">	</span><br><span class="line">	#打开游标</span><br><span class="line">	<span class="keyword">OPEN</span> emp_cursor;	</span><br><span class="line">	</span><br><span class="line">	REPEAT </span><br><span class="line">	#使用游标</span><br><span class="line">	<span class="keyword">FETCH</span> emp_cursor <span class="keyword">INTO</span> emp_sal;#游标的查询结果集中的字段数，必须跟上方表中查询返回的字段数一致</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> sum_sal <span class="operator">=</span> sum_sal <span class="operator">+</span>  emp_sal;</span><br><span class="line">	<span class="keyword">SET</span> n <span class="operator">=</span> n <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">	UNTIL sum_sal <span class="operator">&gt;=</span> limit_total_salary</span><br><span class="line">	<span class="keyword">END</span> REPEAT;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> total_count <span class="operator">=</span> n;</span><br><span class="line">	#关闭游标</span><br><span class="line">	<span class="keyword">CLOSE</span> emp_cursor;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> get_count_by_limit_total_salary(<span class="number">200000</span>,<span class="variable">@total</span>_count);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@total</span>_count;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>举个例子：可以创建一个触发器，让商品信息数据的插入操作自动触发库存数 据的插入操作。 </p>
<p>触发器是由 事件来触发 某个操作，这些事件包括 INSERT 、 UPDATE 、 DELETE 事件。</p>
<p>所谓事件就是指 用户的动作或者触发某项行为。</p>
<h3 id="触发器的创建"><a href="#触发器的创建" class="headerlink" title="触发器的创建"></a>触发器的创建</h3><p>语法结构：</p>
<p>CREATE TRIGGER 触发器名称 </p>
<p>{BEFORE|AFTER} {INSERT|UPDATE|DELETE} ON 表名 </p>
<p>FOR EACH ROW </p>
<p>触发器执行的语句块;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#定义触发器“salary_check_trigger”，基于员工表“employees”的<span class="keyword">INSERT</span>事件，</span><br><span class="line">#在<span class="keyword">INSERT</span>之前检查将要添加的新员工薪资是否大于他领导的薪资，</span><br><span class="line">#如果大于领导薪资，则报sqlstate_value为<span class="string">&#x27;HY000&#x27;</span>的错误，从而使得添加失败。</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> salary_check_trigger</span><br><span class="line">BEFORE <span class="keyword">INSERT</span> <span class="keyword">ON</span> emp</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> </span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">DECLARE</span> mgr_sal <span class="keyword">DOUBLE</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> mgr_sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> employee_id <span class="operator">=</span> new.manager_id;</span><br><span class="line">	</span><br><span class="line">	IF new.salary <span class="operator">&gt;</span> mgr_sal</span><br><span class="line">		<span class="keyword">THEN</span> SIGNAL <span class="keyword">SQLSTATE</span> <span class="string">&#x27;HY000&#x27;</span> <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> <span class="string">&#x27;薪资高于领导薪资错误&#x27;</span>;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line">#触发触发器，添加失败</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(employee_id,last_name,email,hire_date,job_id,salary,manager_id)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">300</span>,<span class="string">&#x27;Jack&#x27;</span>,<span class="string">&#x27;123456@gmail.com&#x27;</span>,CURDATE(),<span class="string">&#x27;AD_VP&#x27;</span>,<span class="number">10000</span>,<span class="number">103</span>);</span><br></pre></td></tr></table></figure>

<h3 id="查看、删除触发器"><a href="#查看、删除触发器" class="headerlink" title="查看、删除触发器"></a>查看、删除触发器</h3><ol>
<li><p>查看触发器</p>
<p>①SHOW TRIGGERS\G</p>
<p>②SHOW CREATE TRIGGER 触发器名称</p>
<p>③SELECT * FROM information_schema.TRIGGERS;</p>
</li>
<li><p>删除触发器</p>
<p>DROP TRIGGER IF EXISTS 触发器名称；</p>
</li>
</ol>
<h3 id="触发器的优缺点"><a href="#触发器的优缺点" class="headerlink" title="触发器的优缺点"></a>触发器的优缺点</h3><p>优点：</p>
<p>①触发器可以确保数据的完整性。因为会同步更新修改或删除的数据</p>
<p>②触发器可以帮助我们记录操作日志。任何操作之前都被记录</p>
<p>③触发器还可以用在操作数据前，对数据进行合法性检查。</p>
<p>缺点：</p>
<p>①触发器最大的一个问题就是可读性差。</p>
<p>②相关数据的变更，可能会导致触发器出错。</p>
<p><strong>注意点：</strong></p>
<p>如果在子表中定义了外键约束，并且外键指定了ON UPDATE&#x2F;DELETE CASCADE&#x2F;SET NULL子句，</p>
<p>此时修改父表被引用的键值或删除父表被引用的记录行时，也会引起子表的修改和删除操作，</p>
<p>此时基于子表的UPDATE和DELETE语句定义的触发器并不会被激活。</p>
<hr>
<h2 id="MySQL8-0-新特性"><a href="#MySQL8-0-新特性" class="headerlink" title="MySQL8.0 新特性"></a>MySQL8.0 新特性</h2><p>窗口函数分为了 <strong>静态窗口函数</strong> 和 <strong>动态窗口函数</strong></p>
<h3 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h3><p>语法格式：</p>
<p>实际上PARTITION BY是可选择的</p>
<p>①<strong>函数 OVER ([PARTITION BY 字段名 ORDER BY 字段名 ASC | DESC])</strong></p>
<p>②**函数  OVER 窗口名 … WINDOW 窗口名 AS ([PARTITION BY 字段名 ORDER BY 字段名 ASC | DESC]) **</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhvKwF.png" alt="相关说明"></p>
<h4 id="序号函数"><a href="#序号函数" class="headerlink" title="序号函数"></a>序号函数</h4><p>ROW_NUMBER()：生成一个呈现分类后序号的列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#查询goods数据表中每个商品分类下价格降序排列的各个商品信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> category_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> price  <span class="keyword">DESC</span>) <span class="keyword">AS</span>  <span class="type">row</span> num,</span><br><span class="line">id,category_id,category,name,price,stock</span><br><span class="line"><span class="keyword">FROM</span> goods;</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2022/03/10/bhvGS1.png" alt="查询结果"></p>
<p>————其他函数用法在此不做说明，</p>
<p><img src="https://s1.ax1x.com/2022/03/10/bhvsSI.png" alt="函数用法"></p>
<h3 id="公用表表达式"><a href="#公用表表达式" class="headerlink" title="公用表表达式"></a>公用表表达式</h3><p>公共表表达式(Common Table Expressions)可以理解为是一个命名的 临时结果集，作用范围是在当前语句中</p>
<p>也可以把它看作一个支持复用的子查询，但与子查询还是不太一样，cte可以引用别的cte，子查询不能引用别的子查询</p>
<p>其中又分为了 <strong>普通公用表表达式</strong> 和 <strong>递归公用表表达式</strong></p>
<h4 id="普通公用表表达式"><a href="#普通公用表表达式" class="headerlink" title="普通公用表表达式"></a>普通公用表表达式</h4><p>语句结构：</p>
<p>WITH CTE名称</p>
<p>AS  (子查询)</p>
<p>SELECT| DELETE | UPDATE 语句；</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> cte_emp</span><br><span class="line"><span class="keyword">AS</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id <span class="keyword">FROM</span> employees);</span><br><span class="line"></span><br><span class="line">#使用cte_emp表</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> department_id <span class="keyword">JOIN</span> cte_emp e</span><br><span class="line"><span class="keyword">on</span> d.department_id <span class="operator">=</span> e.department_id;</span><br></pre></td></tr></table></figure>

<h4 id="递归公用表表达式"><a href="#递归公用表表达式" class="headerlink" title="递归公用表表达式"></a>递归公用表表达式</h4><p>实际就是自己调用自己</p>
<p>语句结构：</p>
<p>WITHRECURSIVE</p>
<p>CTE名称 AS (子查询)</p>
<p>SELECT| DELETE | UPDATE 语句；</p>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Year21</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="http://year21.top/2022/03/10/MySQL1">http://year21.top/2022/03/10/MySQL1</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://xxxccc1986.github.io" target="_blank">Year 21's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://w.wallhaven.cc/full/x8/wallhaven-x82d1d.png" data-sites="facebook,twitter,wechat,qq"></div><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://jsdelivr.pai233.top/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/24/Java%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"><img class="prev-cover" src="https://w.wallhaven.cc/full/z8/wallhaven-z8odwg.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Java环境安装</div></div></a></div><div class="next-post pull-right"><a href="/2022/03/15/JDBC/"><img class="next-cover" src="https://w.wallhaven.cc/full/z8/wallhaven-z86yxw.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JDBC</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s4.ax1x.com/2022/01/18/7BWTQx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Year 21</div><div class="author-info__description">昨天   今天   明天</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxccc1986"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://wpa.qq.com/msgrd?v=3&amp;uin=1483501858&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://t.me/year_21_xx" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a><a class="social-icon" href="mailto:masicjokersic@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">一个不知名的初学者，欢迎指教。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">初识数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.</span> <span class="toc-text">常见数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93-RDBMS"><span class="toc-number">1.2.</span> <span class="toc-text">关系型数据库(RDBMS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93-%E9%9D%9ERDBMS"><span class="toc-number">1.3.</span> <span class="toc-text">非关系型数据库(非RDBMS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%AE%BE%E8%AE%A1%E8%A7%84%E5%88%99"><span class="toc-number">1.4.</span> <span class="toc-text">关系型数据库的设计规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E8%AF%AD%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">SQL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E8%AF%AD%E8%A8%80%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">2.1.</span> <span class="toc-text">SQL语言的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E8%AF%AD%E8%A8%80%E7%9A%84%E8%A7%84%E5%88%99%E4%B8%8E%E8%A7%84%E8%8C%83"><span class="toc-number">2.2.</span> <span class="toc-text">SQL语言的规则与规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E5%A4%A7%E5%B0%8F%E5%86%99%E4%B8%8D%E5%90%8C%E7%8E%AF%E5%A2%83%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.1.</span> <span class="toc-text">SQL大小写不同环境区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%9A%84SELECT%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.</span> <span class="toc-text">基本的SELECT语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.</span> <span class="toc-text">运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.1.</span> <span class="toc-text">算术运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.2.</span> <span class="toc-text">比较运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">4.3.</span> <span class="toc-text">相关关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.4.</span> <span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.5.</span> <span class="toc-text">位运算符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E9%A1%B5"><span class="toc-number">5.</span> <span class="toc-text">排序与分页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">5.1.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5"><span class="toc-number">5.2.</span> <span class="toc-text">分页</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.</span> <span class="toc-text">多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF-%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5-%E7%8E%B0%E8%B1%A1"><span class="toc-number">6.1.</span> <span class="toc-text">笛卡尔积(交叉连接)现象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">6.2.</span> <span class="toc-text">多表查询的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5-%E4%B8%8E-%E9%9D%9E%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.2.1.</span> <span class="toc-text">等值连接  与  非等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5-%E4%B8%8E-%E9%9D%9E%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.2.2.</span> <span class="toc-text">自连接   与   非自连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5-%E4%B8%8E-%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.2.3.</span> <span class="toc-text">内连接   与   外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E7%A7%8DJOIN%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">6.2.4.</span> <span class="toc-text">7种JOIN的方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNION%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">6.3.</span> <span class="toc-text">UNION关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL99%E8%AF%AD%E6%B3%95%E6%96%B0%E7%89%B9%E6%80%A7-%E4%BA%86%E8%A7%A3"><span class="toc-number">6.4.</span> <span class="toc-text">SQL99语法新特性(了解)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">7.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">7.1.</span> <span class="toc-text">单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">7.1.1.</span> <span class="toc-text">数值函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">7.1.2.</span> <span class="toc-text">字符串函数-</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">7.1.3.</span> <span class="toc-text">日期和时间函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-number">7.1.4.</span> <span class="toc-text">流程控制函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">7.2.</span> <span class="toc-text">加密与解密函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0"><span class="toc-number">7.3.</span> <span class="toc-text">MySQL信息函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="toc-number">7.4.</span> <span class="toc-text">其他函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">7.5.</span> <span class="toc-text">多行函数(聚合函数)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.</span> <span class="toc-text">不相关子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.1.</span> <span class="toc-text">单行子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.</span> <span class="toc-text">多行子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">9.</span> <span class="toc-text">相关子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EXISTS-%E4%B8%8E-NOT-EXISTS%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">9.1.</span> <span class="toc-text">EXISTS 与 NOT EXISTS关键字</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">创建和管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E8%AF%86%E7%AC%A6%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">10.1.</span> <span class="toc-text">标识符命名规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%AE%A1%E7%90%86"><span class="toc-number">10.2.</span> <span class="toc-text">数据库 的创建与管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8-%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-number">10.3.</span> <span class="toc-text">数据表 的创建和管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DCL%E3%80%81DDL%E3%80%81DML"><span class="toc-number">11.</span> <span class="toc-text">DCL、DDL、DML</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DCL%E4%B8%AD%E7%9A%84-commit-%E5%92%8C-rollback"><span class="toc-number">11.1.</span> <span class="toc-text">DCL中的 commit 和 rollback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TRUNCATE-TABLE-%E4%B8%8E-DELETE-FROM"><span class="toc-number">11.2.</span> <span class="toc-text">TRUNCATE TABLE 与 DELETE FROM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDL-%E4%B8%8E-DML"><span class="toc-number">11.3.</span> <span class="toc-text">DDL 与 DML</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DML%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9"><span class="toc-number">12.</span> <span class="toc-text">DML的增删改</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">12.1.</span> <span class="toc-text">添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">12.2.</span> <span class="toc-text">更新数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">12.3.</span> <span class="toc-text">删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL8-%E6%96%B0%E7%89%B9%E6%80%A7%EF%BC%9A%E8%AE%A1%E7%AE%97%E5%88%97"><span class="toc-number">12.4.</span> <span class="toc-text">MySQL8 新特性：计算列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.</span> <span class="toc-text">MySQL的数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B-%E6%95%B4%E5%BD%A2"><span class="toc-number">13.1.</span> <span class="toc-text">整数类型(整形)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.2.</span> <span class="toc-text">浮点类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E7%82%B9%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.3.</span> <span class="toc-text">定点数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E7%B1%BB%E5%9E%8B-Bit"><span class="toc-number">13.4.</span> <span class="toc-text">位类型(Bit)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.5.</span> <span class="toc-text">日期和时间类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#YEAR%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.5.1.</span> <span class="toc-text">YEAR类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DATE%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.5.2.</span> <span class="toc-text">DATE类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TIME%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.5.3.</span> <span class="toc-text">TIME类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DATETIME%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.5.4.</span> <span class="toc-text">DATETIME类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TIMESTAMP%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.5.5.</span> <span class="toc-text">TIMESTAMP类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.6.</span> <span class="toc-text">文本字符串类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CHAR-%E3%80%81VARCHAR%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.6.1.</span> <span class="toc-text">CHAR 、VARCHAR类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TEXT%E6%96%87%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.6.2.</span> <span class="toc-text">TEXT文本类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ENUM%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.6.3.</span> <span class="toc-text">ENUM枚举类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SET%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.6.4.</span> <span class="toc-text">SET类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.7.</span> <span class="toc-text">二进制字符串类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BINARY-%E3%80%81VARBINARY%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.7.1.</span> <span class="toc-text">BINARY 、VARBINARY类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BLOB%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.7.2.</span> <span class="toc-text">BLOB类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.7.3.</span> <span class="toc-text">JSON类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.7.4.</span> <span class="toc-text">空间类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.</span> <span class="toc-text">约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">14.1.</span> <span class="toc-text">约束的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.1.1.</span> <span class="toc-text">非空约束*</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.1.2.</span> <span class="toc-text">唯一性约束*</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.1.3.</span> <span class="toc-text">主键约束*</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%A2%9E%E5%88%97"><span class="toc-number">14.1.4.</span> <span class="toc-text">自增列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.1.5.</span> <span class="toc-text">外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E7%AD%89%E7%BA%A7"><span class="toc-number">14.1.5.1.</span> <span class="toc-text">约束等级</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.1.6.</span> <span class="toc-text">检查约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%80%BC%E7%BA%A6%E6%9D%9F"><span class="toc-number">14.1.7.</span> <span class="toc-text">默认值约束*</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%9B%B8%E5%85%B3%E5%AF%B9%E8%B1%A1"><span class="toc-number">15.</span> <span class="toc-text">数据库的相关对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">16.</span> <span class="toc-text">视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="toc-number">16.1.</span> <span class="toc-text">创建视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%A7%86%E5%9B%BE"><span class="toc-number">16.2.</span> <span class="toc-text">查看视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">16.3.</span> <span class="toc-text">更新视图的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">16.4.</span> <span class="toc-text">删除视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">16.5.</span> <span class="toc-text">视图的优缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-%E4%B8%8E-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">17.</span> <span class="toc-text">存储过程 与 存储函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA%E3%80%81%E8%B0%83%E7%94%A8"><span class="toc-number">17.1.</span> <span class="toc-text">存储过程的创建、调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%82%A8%E5%AD%98%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">17.2.</span> <span class="toc-text">储存函数的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">17.3.</span> <span class="toc-text">存储过程和存储函数的对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E7%9A%84%E6%9F%A5%E7%9C%8B%E3%80%81%E4%BF%AE%E6%94%B9%E3%80%81%E5%88%A0%E9%99%A4"><span class="toc-number">17.4.</span> <span class="toc-text">存储过程与存储函数的查看、修改、删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">17.5.</span> <span class="toc-text">存储过程的优缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">18.</span> <span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">18.1.</span> <span class="toc-text">系统变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="toc-number">18.2.</span> <span class="toc-text">用户变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%9D%A1%E4%BB%B6%E4%B8%8E%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">19.</span> <span class="toc-text">定义条件与处理程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%9D%A1%E4%BB%B6"><span class="toc-number">19.1.</span> <span class="toc-text">定义条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">19.2.</span> <span class="toc-text">处理程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">20.</span> <span class="toc-text">流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IF%E7%BB%93%E6%9E%84"><span class="toc-number">20.1.</span> <span class="toc-text">IF结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CASE%E7%BB%93%E6%9E%84"><span class="toc-number">20.2.</span> <span class="toc-text">CASE结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">21.</span> <span class="toc-text">循环结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LOOP%E7%BB%93%E6%9E%84"><span class="toc-number">21.1.</span> <span class="toc-text">LOOP结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WHILE%E7%BB%93%E6%9E%84"><span class="toc-number">21.2.</span> <span class="toc-text">WHILE结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REPEAT%E7%BB%93%E6%9E%84"><span class="toc-number">21.3.</span> <span class="toc-text">REPEAT结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E4%B8%89%E7%A7%8D%E5%BE%AA%E7%8E%AF%E7%9A%84%E5%BC%82%E5%90%8C"><span class="toc-number">21.4.</span> <span class="toc-text">前三种循环的异同</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LEVEL%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">21.5.</span> <span class="toc-text">LEVEL的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ITERATE%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">21.6.</span> <span class="toc-text">ITERATE的使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-number">22.</span> <span class="toc-text">游标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-number">22.1.</span> <span class="toc-text">使用游标的步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">23.</span> <span class="toc-text">触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">23.1.</span> <span class="toc-text">触发器的创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E3%80%81%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">23.2.</span> <span class="toc-text">查看、删除触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">23.3.</span> <span class="toc-text">触发器的优缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL8-0-%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-number">24.</span> <span class="toc-text">MySQL8.0 新特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">24.1.</span> <span class="toc-text">窗口函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%E5%87%BD%E6%95%B0"><span class="toc-number">24.1.1.</span> <span class="toc-text">序号函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E7%94%A8%E8%A1%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">24.2.</span> <span class="toc-text">公用表表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E5%85%AC%E7%94%A8%E8%A1%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">24.2.1.</span> <span class="toc-text">普通公用表表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E5%85%AC%E7%94%A8%E8%A1%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">24.2.2.</span> <span class="toc-text">递归公用表表达式</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/25/ComputerStore/" title="SpringBoot+MyBatis+BootStrap3.0前后端不分离项目"><img src="https://w.wallhaven.cc/full/x8/wallhaven-x8rgz3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot+MyBatis+BootStrap3.0前后端不分离项目"/></a><div class="content"><a class="title" href="/2022/07/25/ComputerStore/" title="SpringBoot+MyBatis+BootStrap3.0前后端不分离项目">SpringBoot+MyBatis+BootStrap3.0前后端不分离项目</a><time datetime="2022-07-25T14:53:30.000Z" title="发表于 2022-07-25 22:53:30">2022-07-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/07/DeployPersonalProjectsOnLinux/" title="如何在Linux上部署个人项目？"><img src="https://w.wallhaven.cc/full/d5/wallhaven-d59deo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何在Linux上部署个人项目？"/></a><div class="content"><a class="title" href="/2022/07/07/DeployPersonalProjectsOnLinux/" title="如何在Linux上部署个人项目？">如何在Linux上部署个人项目？</a><time datetime="2022-07-07T15:56:30.000Z" title="发表于 2022-07-07 23:56:30">2022-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/07/ManagementSystem/" title="SpringBoot+Vue的前后端分离项目"><img src="https://w.wallhaven.cc/full/k7/wallhaven-k7q797.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot+Vue的前后端分离项目"/></a><div class="content"><a class="title" href="/2022/07/07/ManagementSystem/" title="SpringBoot+Vue的前后端分离项目">SpringBoot+Vue的前后端分离项目</a><time datetime="2022-07-07T15:20:16.000Z" title="发表于 2022-07-07 23:20:16">2022-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/07/MyBatis-plus/" title="MyBatis-Plus"><img src="https://s1.ax1x.com/2022/07/07/j0r9zR.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MyBatis-Plus"/></a><div class="content"><a class="title" href="/2022/07/07/MyBatis-plus/" title="MyBatis-Plus">MyBatis-Plus</a><time datetime="2022-07-07T15:00:02.000Z" title="发表于 2022-07-07 23:00:02">2022-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/23/Volatile/" title="Volatile关键字"><img src="https://w.wallhaven.cc/full/z8/wallhaven-z8751j.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Volatile关键字"/></a><div class="content"><a class="title" href="/2022/05/23/Volatile/" title="Volatile关键字">Volatile关键字</a><time datetime="2022-05-23T15:07:02.000Z" title="发表于 2022-05-23 23:07:02">2022-05-23</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://w.wallhaven.cc/full/x8/wallhaven-x82d1d.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 By Year 21</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">心之所向，皆可抵达</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://jsdelivr.pai233.top/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://jsdelivr.pai233.top/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://jsdelivr.pai233.top/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'FdeA2Fr167tRipdBpVUi0fvz-gzGzoHsz',
      appKey: 'roCcb1ljCCFK13sNVcwK4VJi',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://jsdelivr.pai233.top/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><div class="aplayer no-destroy" data-id="6712227171" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://jsdelivr.pai233.top/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://jsdelivr.pai233.top/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://jsdelivr.pai233.top/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script>(function(d, w, c) {
    w.ChatraID = 'Z2tPHYia3jhnSPJ3K';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://jsdelivr.pai233.top/npm/aplayer/dist/APlayer.min.js"></script><script src="https://jsdelivr.pai233.top/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://jsdelivr.pai233.top/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>